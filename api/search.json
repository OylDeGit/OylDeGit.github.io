[{"id":"ad4f5193bdfc54e583fe238ffef546fa","title":"æ¨èçš„","content":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub.\nQuick StartCreate a new post$ hexo new &quot;My New Post&quot;\n\nMore info: Writing\nRun server$ hexo server\n\nMore info: Server\nGenerate static files$ hexo generate\n\nMore info: Generating\nDeploy to remote sites$ hexo deploy\n\nMore info: Deployment\n","slug":"hello-world","date":"2023-02-11T03:24:31.902Z","categories_index":"","tags_index":"","author_index":"é“¾æ¡¥"},{"id":"93fcfece537eb52bb032703811654297","title":"å€æŠ•","content":"ç»¼åˆæ¸—é€ - ç¤¾å·¥åº“æœºå™¨äººé¡¹ç›®å¼€å‘è¿›åº¦ğŸ”¥ æ€»ä½“è¿›åº¦: â– â– â– â– â– â– â– â–¡â–¡ 80%ğŸ“Š å¼€å‘è¿›åº¦æ›´æ–°\nâœ… 0x012222222222  ä¸»èœå•ä¸‡èƒ½æŸ¥è¯¢åŠŸèƒ½å·²å®Œæˆ(åŸé»˜è®¤æ¨¡ç³ŠæŸ¥è¯¢)\nğŸš« 0x02  çŒé­”åŠŸèƒ½(æ­£åœ¨å®Œå–„)\nâœ… 0x03  ä¸»èœå•æ‰‹æœºå·æŸ¥è¯¢åŠŸèƒ½å·²å®Œæˆ\nâœ… 0x04  ä¸»èœå•èº«ä»½è¯æŸ¥è¯¢åŠŸèƒ½å·²å®Œæˆ\nâœ… 0x05  ä¸»èœå•QQå·æŸ¥è¯¢åŠŸèƒ½å·²å®Œæˆ\nâœ… 0x06  ä¸»èœå•å¾®åšæŸ¥è¯¢åŠŸèƒ½å·²å®Œæˆ\nâœ… 0x07  æ•°æ®åº“åˆ—è¡¨è·³è½¬æŒ‰é’®(å¯æŸ¥çœ‹å½“å‰æ•°æ®åº“åˆ—è¡¨)\nâœ… 0x08  ç•Œé¢UIä¼˜åŒ–ã€è‡ªåŠ¨æ£€æµ‹æ‰‹æœºå·å½’å±åœ°ã€å½’å±è¿è¥å•†\nâœ… 0x09  ä¸Šä¸‹ç¿»é¡µåŠŸèƒ½\nğŸš« 0x10  æ™ºèƒ½æŸ¥è¯¢(æ­£åœ¨å¼€å‘)\nğŸš« 0x11  é‚®ç®±æŸ¥è¯¢(æ­£åœ¨å¼€å‘)\nğŸš« 0x12  TGåè¯ˆä¸­å¿ƒ(æ­£åœ¨å¼€å‘)\nğŸš« 0x13  ä¸ªäººä¸­å¿ƒ(æ­£åœ¨å¼€å‘)\nâœ… 0x14  è·å–ç”¨æˆ·UIDåŠŸèƒ½\n\nğŸ”± æ•°æ®è¡¥å……(è§TGå·²å…¥åº“æ•°æ®åˆ—è¡¨æˆ–ç‚¹å‡»æ­¤å¤„)ğŸ· é—®é¢˜åˆ—è¡¨\nâ“ é»˜è®¤æœç´¢ç»“æœä¸å‡†ç¡®é—®é¢˜(æ­£åœ¨å®Œå–„)\nâ“ ç¿»é¡µåæœç´¢ç»“æœä¸ä¸€è‡´é—®é¢˜(æ­£åœ¨å®Œå–„)\nâ“ /xxx å‘½ä»¤å½¢å¼æŸ¥è¯¢åŠŸèƒ½æš‚ä¸å¼€å‘(å…¶ä»–åŠŸèƒ½ä¼˜å…ˆ)\nâœ¨ æ¬¢è¿å„ä½è‚¡ä¸œä»¬æŒç»­æä¾›å®è´µæ„è§ï¼Œè¿›ä¸€æ­¥å®Œå–„æœºå™¨äººçš„åŠŸèƒ½åŠå…¶ä»–æ–¹å‘\nâœ¨ å¸Œæœ›å„ä½å¤§ä½¬ä»¬ç»§ç»­æ¨å¹¿å’Œæä¾›è£¤å­\n\nâœ… å·²è§£å†³é—®é¢˜åˆ—è¡¨\nâœ¨ è”ç³»ç»„ç»‡\nğŸŠ è®¨è®ºç¾¤ç»„: ç”µæ¢¯ç›´è¾¾\nğŸŠ ç¤¾å·¥æœºå™¨äºº: ç”µæ¢¯ç›´è¾¾\nğŸŠ å‘å¸ƒé¢‘é“: ç”µæ¢¯ç›´è¾¾\n\n","slug":"test4","date":"2021-09-30T15:32:04.000Z","categories_index":"ç©æ³•æŠ€å·§","tags_index":"","author_index":"é“¾æ¡¥"},{"id":"facc000dfb043244116199083f898dce","title":"å¨±ä¹","content":"å†…å®¹ï¼š å¨±ä¹ç½‘ç«™ä»‹ç»\n","slug":"test3","date":"2021-09-28T15:32:04.000Z","categories_index":"å¨±ä¹ç½‘ç«™ä»‹ç»","tags_index":"","author_index":"é“¾æ¡¥"},{"id":"0313e750202f9c7b7862cfc3769049b3","title":"æµ‹è¯•2","content":"è½¯ä»¶è¡€ç»Ÿ\n","slug":"test2","date":"2021-09-27T15:32:04.000Z","categories_index":"è½¯ä»¶å­¦å ‚","tags_index":"","author_index":"é“¾æ¡¥"},{"id":"ff294b41f6454d72b979d968dd4769d6","title":"æµ‹è¯•","content":"ä¸Šä¸€éƒ¨åˆ†æˆ‘ä»¬å®Œæˆäº†ä» HTTP å‘é€ Requestï¼Œåˆ°æ¥æ”¶åˆ° Responseï¼Œå¹¶ä¸”æŠŠ Response ä¸­çš„æ–‡æœ¬éƒ½è§£æå‡ºæ¥ã€‚\nè¿™ä¸€éƒ¨åˆ†æˆ‘ä»¬ä¸»è¦è®²è§£å¦‚ä½•åš HTML è§£æ å’Œ CSS è®¡ç®—è¿™ä¸¤ä¸ªéƒ¨åˆ†ã€‚\n\næ ¹æ®æˆ‘ä»¬ä¸Šéƒ¨åˆ†åˆ—å‡ºçš„ä¸€ä¸ªå®Œæ•´çš„æµè§ˆå™¨æ¶æ„çš„è¯ï¼Œè“è‰²èƒŒæ™¯çš„éƒ¨åˆ†å°±æ˜¯æˆ‘ä»¬ç›®å‰å·²ç»å®Œæˆçš„æµç¨‹ã€‚\n\nHTML è§£æHTML parse æ¨¡å—çš„æ–‡ä»¶æ‹†åˆ†æ€è·¯ï¼š\n\nä¸ºäº†æ–¹ä¾¿æ–‡ä»¶ç®¡ç†ï¼Œæˆ‘ä»¬æŠŠ parser å•ç‹¬æ‹†åˆ†åˆ°æ–‡ä»¶ä¸­\nparser æ¥æ”¶ HTML æ–‡æœ¬ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€æ£µ DOM æ ‘\n\nåŠ å…¥ HTML Parser\n\nä¸Šä¸€ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬æœ€åè·å¾—äº†ä¸€ä¸ª Response å¯¹è±¡\nè¿™é‡Œæˆ‘ä»¬å°±è€ƒè™‘å¦‚ä½•åˆ©ç”¨è¿™ä¸ª Response ä¸­çš„ body å†…å®¹\næ‰€ä»¥æˆ‘ä»¬åº”è¯¥ä»è·å¾— Response ä¹‹åï¼ŒæŠŠ body å†…å®¹ä¼ ç»™ parser ä¸­çš„ parseHTML æ–¹æ³•è¿›è¡Œè§£æ\nåœ¨çœŸæ­£çš„æµè§ˆå™¨ä¸­ï¼Œæˆ‘ä»¬æ˜¯åº”è¯¥é€æ®µçš„ä¼ ç»™ parser å¤„ç†ï¼Œç„¶åé€æ®µçš„è¿”å›\nå› ä¸ºè¿™é‡Œæˆ‘ä»¬çš„ç›®æ ‡åªæ˜¯ç®€å•å®ç°æµè§ˆå™¨å·¥ä½œçš„åŸç†ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ç»Ÿä¸€è§£æç„¶åè¿”å›å°±å¥½\nè¿™æ ·æˆ‘ä»¬æ›´å®¹æ˜“ç†è§£ï¼Œä»£ç ä¹Ÿæ›´åŠ æ¸…æ™°æ˜“æ‡‚\n\n\n\n\n\n\n\n\n\n\næ–‡ä»¶ï¼šclient.js\n// è¿™ä¸ªæ˜¯ client.js\n\n&#x2F;&#x2F; 1. å¼•å…¥ parser.jsconst parser &#x3D; require(â€˜.&#x2F;parser.jsâ€™)\n&#x2F;&#x2F; â€¦&#x2F;&#x2F;â€¦ ä¹‹å‰çš„ä»£ç åœ¨æ­¤å¤„å¿½ç•¥&#x2F;&#x2F; â€¦\nlet response &#x3D; await request.send()\n&#x2F;&#x2F; 2. åœ¨ è¯·æ±‚æ–¹æ³• ä¸­ï¼Œè·å¾— response ååŠ å…¥ HTML çš„è§£æä»£ç let dom &#x3D; parser.parseHTML(response.body)Copy\n\n\n\n\n\n\n\n\n\næ–‡ä»¶ï¼šparser.js\n/**\n * è§£æå™¨\n * @filename parser.js\n * @author ä¸‰é’»\n * @version v1.0.0\n */\n\nmodule.exports.parseHTML &#x3D; function (html) &#123;  console.log(html) &#x2F;&#x2F; è¿™é‡Œæˆ‘ä»¬å…ˆ console.log æ‰“å°ä¸€ä¸‹è¿”å›çš„ HTML å†…å®¹&#125;Copy\nç”¨æœ‰æ•ˆçŠ¶æ€æœº (FSM) å®ç° HTML çš„åˆ†æ\næˆ‘ä»¬ç”¨ FSM æ¥å®ç° HTML çš„åˆ†æ\nåœ¨ HTML æ ‡å‡†ä¸­ï¼Œå·²ç»è§„å®šäº† HTML çš„çŠ¶æ€\næˆ‘ä»¬çš„æµè§ˆå™¨åªæŒ‘é€‰å…¶ä¸­ä¸€éƒ¨åˆ†çŠ¶æ€ï¼Œå®Œæˆä¸€ä¸ªæœ€ç®€ç‰ˆæœ¬\n\nHTML æ ‡å‡†é‡Œé¢å·²ç»æŠŠæ•´ä¸ªçŠ¶æ€æœºä¸­çš„çŠ¶æ€éƒ½è®¾è®¡å¥½äº†ï¼Œæˆ‘ä»¬ç›´æ¥å°±çœ‹ HTML æ ‡å‡†ä¸­ç»™æˆ‘ä»¬è®¾è®¡å¥½çš„çŠ¶æ€ï¼šhttps://html.spec.whatwg.org/multipage/ï¼Œæˆ‘ä»¬ç›´æ¥ç¿»åˆ° â€œTokenizationâ€ æŸ¥çœ‹åˆ—å‡ºçš„çŠ¶æ€ï¼Œè¿™é‡Œå°±æ˜¯æ‰€æœ‰ HTML çš„è¯æ³•ã€‚\næœ‰äº›åŒå­¦åœ¨è¯»è¿™ä¸ªæ ‡å‡†çš„æ—¶å€™ä¼šè¯´ â€œæˆ‘çœ‹ä¸æ‡‚â€ï¼Œâ€œæˆ‘å¤ªéš¾äº†â€ï¼Œâ€œæˆ‘çœ‹æ‡µäº†â€ã€‚å…¶å®æˆ‘ä»¬çœ‹ä¸æ‡‚æ˜¯å› ä¸ºè¿™é‡Œé¢çš„æ ‡å‡†æ˜¯å†™ç»™æµè§ˆå™¨å®ç°è€…å»çœ‹çš„ï¼Œä½†æ˜¯ç”¨å®ç°æˆ‘ä»¬çš„æµè§ˆå™¨çš„çŠ¶æ€æœºä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹æ‡‚äº†ï¼Œè€Œä¸”å‘ç°è¿™é‡Œé¢å†™çš„éå¸¸åƒæˆ‘ä»¬çš„ä»£ç ã€‚è¿™ä¸ªæ ‡å‡†ä¸­å†™çš„å°±æ˜¯ä¼ªä»£ç ã€‚æˆ‘ä»¬åªéœ€è¦æŠŠè¿™é‡Œé¢çš„ä¼ªä»£ç å†™æˆçœŸå®ä»£ç å°±å¯ä»¥äº†ã€‚\nåœ¨ HTML ä¸­æœ‰ 80 ä¸ªçŠ¶æ€ï¼Œä½†æ˜¯åœ¨æˆ‘ä»¬è¿™é‡Œï¼Œå› ä¸ºåªéœ€è¦èµ°ä¸€éæµè§ˆå™¨å·¥ä½œçš„æµç¨‹ï¼Œæˆ‘ä»¬å°±ä¸ä¸€ä¸€å®ç°äº†ï¼Œæˆ‘ä»¬åœ¨å…¶ä¸­æŒ‘é€‰ä¸€éƒ¨åˆ†æ¥å®ç°å³å¯ã€‚\nä¸‹é¢æˆ‘ä»¬æ¥åˆå§‹åŒ–ä¸€ä¸‹æˆ‘ä»¬çš„ parseHTML çš„çŠ¶æ€æœºï¼šï¼ˆæŠŠä¸Šé¢çš„ parser.js çš„åŸºç¡€ä¸Šè¿›è¡Œä¿®æ”¹ï¼‰\n\n\n\n\n\n\n\n\n\næ–‡ä»¶ï¼šparser.js\n/**\n * è§£æå™¨\n * @filename parser.js\n * @author ä¸‰é’»\n * @version v1.0.0\n */\n\nconst EOF &#x3D; Symbol(â€˜EOFâ€™) &#x2F;&#x2F; EOF: end of file\nfunction data(char) &#123;&#125;\n&#x2F;**\n\nHTTP è§£æ\n@param &#123;string&#125; html æ–‡æœ¬ *&#x2F;module.exports.parseHTML &#x3D; function (html) &#123;  let state &#x3D; data  for (let char of html) &#123; state &#x3D; state(char)  &#125;  state &#x3D; state(EOF)&#125;Copy\n\n\n\n\n\n\n\n\n\n\n\nä¸Šé¢çš„ä»£ç ä¸­ç”¨äº†ä¸€ä¸ªå°æŠ€å·§ï¼Œå› ä¸º HTML æœ€åæ˜¯æœ‰ä¸€ä¸ªæ–‡ä»¶ç»ˆç»“çš„\næ‰€æœ‰æœ€åéœ€è¦ç»™ä»–ä¸€ä¸ªç»“æŸå­—ç¬¦ï¼ˆé‡ç‚¹æ˜¯è¿™é‡Œç”¨ä¸€ä¸ªæ²¡æœ‰ç‰¹åˆ«æ„ä¹‰çš„å­—ç¬¦ï¼‰\næˆ‘ä»¬è¿™é‡Œä½¿ç”¨äº† Symbol åˆ›å»ºäº†ä¸€ä¸ª EOF å­—ç¬¦ï¼Œä»£è¡¨ End of file (æ–‡ä»¶ç»“æŸ)\n\nè§£ææ ‡ç­¾HTML æœ‰ä¸‰ç§æ ‡ç­¾\n\nå¼€å§‹æ ‡ç­¾\nç»“æŸæ ‡ç­¾\nè‡ªå°é—­æ ‡ç­¾\n\næ€è·¯ï¼š\n\nä¸»è¦çš„æ ‡ç­¾æœ‰ï¼šå¼€å§‹æ ‡ç­¾ï¼Œç»“æŸæ ‡ç­¾å’Œè‡ªå°é—­æ ‡ç­¾\nåœ¨è¿™ä¸€æ­¥æˆ‘ä»¬æš‚æ—¶å¿½ç•¥å±æ€§\n\n\n\n\n\n\n\n\n\n\næ–‡ä»¶ï¼šparser.js\n/**\n * è§£æå™¨\n * @filename parser.js\n * @author ä¸‰é’»\n * @version v1.0.0\n */\n\nconst EOF &#x3D; Symbol(â€˜EOFâ€™) &#x2F;&#x2F; EOF: end of file\n&#x2F;**\n\nHTML æ•°æ®å¼€å§‹é˜…è¯»çŠ¶æ€\n\n\n\nå¦‚æœæ‰¾åˆ° &amp;lt; å°±æ˜¯æ ‡ç­¾å¼€å§‹çŠ¶æ€\n\n\n\nå¦‚æœæ‰¾åˆ° EOF å°±æ˜¯HTMLæ–‡æœ¬ç»“æŸ\n\n\n\nå…¶ä»–å­—ç¬¦å°±ç»§ç»­å¯»æ‰¾\n\n\n@param {*} char\n\n@return {function} *&#x2F;function data(char) {  if (char &#x3D;&#x3D;&#x3D; â€˜&lt;â€™) { &#x2F;&#x2F; æ ‡ç­¾å¼€å§‹ return tagOpen  } else if (char &#x3D;&#x3D;&#x3D; EOF) { &#x2F;&#x2F; æ–‡æœ¬ç»“æŸ return  } else { return data  }}\n\n&#x2F;**\n\næ ‡ç­¾å¼€å§‹çŠ¶æ€\n\n\n\nå¦‚æœæ‰¾åˆ° / è¯æ˜æ˜¯è‡ªå…³é—­æ ‡ç­¾\n\n\n\nå¦‚æœæ˜¯å­—æ¯å°±æ˜¯æ ‡ç­¾å\n\n\n\nå…¶ä»–å­—ç¬¦å°±ç›´æ¥ç»§ç»­å¯»æ‰¾\n\n\n@param {*} char *&#x2F;function tagOpen(char) {  if (char &#x3D;&#x3D;&#x3D; â€˜&#x2F;â€˜) { &#x2F;&#x2F; è‡ªå…³é—­æ ‡ç­¾ return endTagOpen  } else if (char.match(&#x2F;^[a-zA-Z]$&#x2F;)) { &#x2F;&#x2F; æ ‡ç­¾å return tagName(char)  } else { return  }}\n\n&#x2F;**\n\næ ‡ç­¾ç»“æŸçŠ¶æ€\n\n\n\nå¦‚æœæ˜¯å­—æ¯å°±æ˜¯æ ‡ç­¾å\n\n\n\nå¦‚æœç›´æ¥æ˜¯ &amp;gt; å°±æŠ¥é”™\n\n\n\nå¦‚æœæ˜¯ç»“æŸç¬¦åˆï¼Œä¹Ÿæ˜¯æŠ¥é”™\n\n\n@param {*} char *&#x2F;function endTagOpen(char) {  if (char.match(&#x2F;^[a-zA-Z]$&#x2F;)) { return tagName(char)  } else if (char &#x3D;&#x3D;&#x3D; â€˜&gt;â€™) { &#x2F;&#x2F; æŠ¥é”™ â€”â€” æ²¡æœ‰ç»“æŸæ ‡ç­¾  } else if (char &#x3D;&#x3D;&#x3D; EOF) { &#x2F;&#x2F; æŠ¥é”™ â€”â€” ç»“æŸæ ‡ç­¾ä¸åˆæ³•  }}\n\n&#x2F;**\n\næ ‡ç­¾åçŠ¶æ€\n\n\n\nå¦‚æœ \\t(Tabç¬¦)ã€\\n(ç©ºæ ¼ç¬¦)ã€\\f(ç¦æ­¢ç¬¦)æˆ–è€…æ˜¯ç©ºæ ¼ï¼Œè¿™é‡Œå°±æ˜¯å±æ€§çš„å¼€å§‹\n\n\n\nå¦‚æœæ‰¾åˆ° / å°±æ˜¯è‡ªå…³é—­æ ‡ç­¾\n\n\n\nå¦‚æœæ˜¯å­—æ¯å­—ç¬¦é‚£è¿˜æ˜¯æ ‡ç­¾å\n\n\n\nå¦‚æœæ˜¯ &amp;gt; å°±æ˜¯å¼€å§‹æ ‡ç­¾ç»“æŸ\n\n\n\nå…¶ä»–å°±æ˜¯ç»§ç»­å¯»æ‰¾æ ‡ç­¾å\n\n\n@param {*} char *&#x2F;function tagName(char) {  if (c.match(&#x2F;^[\\t\\n\\f ]$&#x2F;)) { return beforeAttributeName  } else if (char &#x3D;&#x3D;&#x3D; â€˜&#x2F;â€˜) { return selfClosingStartTag  } else if (c.match(&#x2F;^[a-zA-Z]$&#x2F;)) { return tagName  } else if (char &#x3D;&#x3D;&#x3D; â€˜&gt;â€™) { return data  } else { return tagName  }}\n\n&#x2F;**\n\næ ‡ç­¾å±æ€§çŠ¶æ€\n\n\n\nå¦‚æœé‡åˆ° / å°±æ˜¯è‡ªå°é—­æ ‡ç­¾çŠ¶æ€\n\n\n\nå¦‚æœé‡åˆ°å­—æ¯å°±æ˜¯å±æ€§å\n\n\n\nå¦‚æœé‡åˆ° &amp;gt; å°±æ˜¯æ ‡ç­¾ç»“æŸ\n\n\n\nå¦‚æœé‡åˆ° = ä¸‹æ¥å°±æ˜¯å±æ€§å€¼\n\n\n\nå…¶ä»–æƒ…å†µç»§ç»­è¿›å…¥å±æ€§æŠ“å–\n\n\n@param {*} char *&#x2F;function beforeAttributeName(char) {  if (char &#x3D;&#x3D;&#x3D; â€˜&#x2F;â€˜) { return selfClosingStartTag  } else if (char.match(&#x2F;^[\\t\\n\\f ]$&#x2F;)) { return beforeAttributeName  } else if (char &#x3D;&#x3D;&#x3D; â€˜&gt;â€™) { return data  } else if (char &#x3D;&#x3D;&#x3D; â€˜&#x3D;â€™) { return beforeAttributeName  } else { return beforeAttributeName  }}\n\n&#x2F;**\n\nè‡ªå°é—­æ ‡ç­¾çŠ¶æ€\n\n\n\nå¦‚æœé‡åˆ° &amp;gt; å°±æ˜¯è‡ªå°é—­æ ‡ç­¾ç»“æŸ\n\n\n\nå¦‚æœé‡åˆ° EOF å³ä½¿æŠ¥é”™\n\n\n\nå…¶ä»–å­—ç¬¦ä¹Ÿæ˜¯æŠ¥é”™\n\n\n@param {*} char *&#x2F;function selfClosingStartTag(char) {  if (char &#x3D;&#x3D;&#x3D; â€˜&gt;â€™) { return data  } else if (char &#x3D;&#x3D;&#x3D; â€˜EOFâ€™) {  } else {  }}\n\n&#x2F;**\n\nHTTP è§£æ\n@param {string} html æ–‡æœ¬ *&#x2F;module.exports.parseHTML &#x3D; function (html) {  let state &#x3D; data  for (let char of html) { state &#x3D; state(char)  }  state &#x3D; state(EOF)}Copy\n\nåˆ›å»ºå…ƒç´ \nåœ¨çŠ¶æ€æœºä¸­ï¼Œé™¤äº†çŠ¶æ€è¿ç§»ï¼Œæˆ‘ä»¬è¿˜ä¼šåŠ å…¥ä¸šåŠ¡é€»è¾‘\næˆ‘ä»¬åœ¨æ ‡ç­¾ç»“æŸçŠ¶æ€æäº¤æ ‡ç­¾ token\n\nä¸šåŠ¡é€»è¾‘ï¼š\n\né¦–å…ˆæˆ‘ä»¬éœ€è¦å»ºç«‹ä¸€ä¸ª currentToken æ¥æš‚å­˜å½“å‰çš„ Tokenï¼ˆè¿™é‡Œæˆ‘ä»¬æ˜¯ç”¨äºå­˜æ”¾å¼€å§‹å’Œç»“æŸæ ‡ç­¾ token çš„ï¼‰\nç„¶åå»ºç«‹ä¸€ä¸ª emit() æ–¹æ³•æ¥æ¥æ”¶æœ€ååˆ›å»ºå®Œæ¯•çš„ Tokenï¼ˆè¿™é‡Œåé¢ä¼šç”¨é€ä¸ª Token æ¥åˆ›å»º DOM æ ‘ï¼‰\nHTML æ•°æ®å¼€å§‹çŠ¶æ€ â€”â€” data\nå¦‚æœæ‰¾åˆ°çš„æ˜¯ EOFï¼Œé‚£å°±ç›´æ¥ emit ä¸€ä¸ª type: â€˜EOFâ€™ çš„ Token\nå¦‚æœæ˜¯æ–‡æœ¬å†…å®¹çš„è¯ï¼Œç›´æ¥ emit &#123;type: 'text', content: char&#125; çš„ token\n\n\næ ‡ç­¾å¼€å§‹çŠ¶æ€ â€”â€” tagOpen\nå¦‚æœåŒ¹é…ä¸­çš„æ˜¯å­—æ¯ï¼Œé‚£å°±æ˜¯å¼€å§‹æ ‡ç­¾\nç›´æ¥è®°å½•å¼€å§‹æ ‡ç­¾ Token å¯¹è±¡ &#123;type: 'startTag, tagName: ''&#125;\nåœ¨ tagName() çŠ¶æ€ä¸­æˆ‘ä»¬ä¼šæŠŠæ•´ä¸ªå®Œæ•´çš„æ ‡ç­¾åæ‹¼æ¥å¥½\n\n\næ ‡ç­¾ç»“æŸçŠ¶æ€ â€”â€” endTagOpen\nå¦‚æœåŒ¹é…åˆ°å­—ç¬¦ï¼Œé‚£å°±æ˜¯ç»“æŸæ ‡ç­¾å\nç›´æ¥è®°å½•ç»“æŸæ ‡ç­¾ Token å¯¹è±¡ &#123;type: 'endTag', tagName: ''&#125;\né›·åŒï¼Œåé¢ä¼šåœ¨ tagName() çŠ¶æ€ä¸­æˆ‘ä»¬ä¼šæŠŠæ•´ä¸ªå®Œæ•´çš„æ ‡ç­¾åæ‹¼æ¥å¥½\n\n\næ ‡ç­¾åçŠ¶æ€ â€”â€” tagName\nè¿™é‡Œå°±æ˜¯æœ€æ ¸å¿ƒçš„ä¸šåŠ¡åŒºäº†\nåœ¨ç¬¬ä¸‰ç§æƒ…å†µä¸‹ï¼ŒåŒ¹é…åˆ°å­—æ¯æ—¶ï¼Œé‚£å°±æ˜¯éœ€è¦æ‹¼æ¥æ ‡ç­¾åçš„æ—¶å€™\nè¿™é‡Œæˆ‘ä»¬ç›´æ¥ç»™ currentTag è¿½åŠ å­—æ¯å³å¯\nå½“æˆ‘ä»¬åŒ¹é…åˆ° &gt; å­—ç¬¦æ—¶ï¼Œå°±æ˜¯è¿™ä¸ªæ ‡ç­¾ç»“æŸçš„æ—¶å€™ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å·²ç»æ‹¥æœ‰ä¸€ä¸ªå®Œæ•´çš„æ ‡ç­¾ Token äº†\næ‰€ä»¥è¿™é‡Œæˆ‘ä»¬ç›´æ¥æŠŠ currentToken emit å‡ºå»\n\n\næ ‡ç­¾å±æ€§çŠ¶æ€ â€”â€” beforeAttributeName\nåœ¨åŒ¹é…åˆ° &gt; å­—ç¬¦çš„æ—¶å€™ï¼Œè¿™é‡Œå°±æ˜¯æ ‡ç­¾ç»“æŸçš„æ—¶å€™ï¼Œæ‰€ä»¥å¯ä»¥ emit currentToken çš„æ—¶å€™\n\n\nè‡ªå°é—­æ ‡ç­¾çŠ¶æ€ â€”â€” selfClosingStartTag\nè¿™é‡Œè¿½åŠ äº†ä¸€ä¸ªé€»è¾‘\nåœ¨åŒ¹é…åˆ° &gt; å­—ç¬¦æ—¶ï¼Œå°±æ˜¯è‡ªé—­æ ‡ç­¾ç»“æŸçš„æ—¶å€™\nè¿™é‡Œæˆ‘ä»¬ç›´æ¥ç»™ currentToken è¿½åŠ ä¸€ä¸ª isSelfClosing = true çš„çŠ¶æ€\nç„¶åç›´æ¥å¯ä»¥æŠŠ currentToken emit å‡ºå»äº†\n\n\n\n\n\n\n\n\n\n\n\n\næ–‡ä»¶ï¼šparser.js\n/**\n * è§£æå™¨\n * @filename parser.js\n * @author ä¸‰é’»\n * @version v1.0.0\n */\n\nlet currentToken &#x3D; null\n&#x2F;**\n\nè¾“å‡º HTML token\n@param &#123;*&#125; token *&#x2F;function emit(token) &#123;  console.log(token)&#125;\n\nconst EOF &#x3D; Symbol(â€˜EOFâ€™) &#x2F;&#x2F; EOF: end of file\n&#x2F;**\n\nHTML æ•°æ®å¼€å§‹é˜…è¯»çŠ¶æ€\n\n\n\nå¦‚æœæ‰¾åˆ° &amp;lt; å°±æ˜¯æ ‡ç­¾å¼€å§‹çŠ¶æ€\n\n\n\nå¦‚æœæ‰¾åˆ° EOF å°±æ˜¯HTMLæ–‡æœ¬ç»“æŸ\n\n\n\nå…¶ä»–å­—ç¬¦å°±ç»§ç»­å¯»æ‰¾\n\n\n@param {*} char\n\n@return {function} *&#x2F;function data(char) {  if (char &#x3D;&#x3D;&#x3D; â€˜&lt;â€™) { &#x2F;&#x2F; æ ‡ç­¾å¼€å§‹ return tagOpen  } else if (char &#x3D;&#x3D;&#x3D; EOF) { &#x2F;&#x2F; æ–‡æœ¬ç»“æŸ emit({   type: â€˜EOFâ€™, }) return  } else { &#x2F;&#x2F; æ–‡æœ¬ emit({   type: â€˜textâ€™,   content: char, }) return data  }}\n\n&#x2F;**\n\næ ‡ç­¾å¼€å§‹çŠ¶æ€\n\n\n\nå¦‚æœæ‰¾åˆ° / è¯æ˜æ˜¯è‡ªå…³é—­æ ‡ç­¾\n\n\n\nå¦‚æœæ˜¯å­—æ¯å°±æ˜¯æ ‡ç­¾å\n\n\n\nå…¶ä»–å­—ç¬¦å°±ç›´æ¥ç»§ç»­å¯»æ‰¾\n\n\n@param {*} char *&#x2F;function tagOpen(char) {  if (char &#x3D;&#x3D;&#x3D; â€˜&#x2F;â€˜) { &#x2F;&#x2F; è‡ªå…³é—­æ ‡ç­¾ return endTagOpen  } else if (char.match(&#x2F;^[a-zA-Z]$&#x2F;)) { &#x2F;&#x2F; æ ‡ç­¾å currentToken &#x3D; {   type: â€˜startTagâ€™,   tagName: â€˜â€™, } return tagName(char)  } else { return  }}\n\n&#x2F;**\n\næ ‡ç­¾ç»“æŸçŠ¶æ€\n\n\n\nå¦‚æœæ˜¯å­—æ¯å°±æ˜¯æ ‡ç­¾å\n\n\n\nå¦‚æœç›´æ¥æ˜¯ &amp;gt; å°±æŠ¥é”™\n\n\n\nå¦‚æœæ˜¯ç»“æŸç¬¦åˆï¼Œä¹Ÿæ˜¯æŠ¥é”™\n\n\n@param {*} char *&#x2F;function endTagOpen(char) {  if (char.match(&#x2F;^[a-zA-Z]$&#x2F;)) { currentToken &#x3D; {   type: â€˜endTagâ€™,   tagName: â€˜â€™, } return tagName(char)  } else if (char &#x3D;&#x3D;&#x3D; â€˜&gt;â€™) { &#x2F;&#x2F; æŠ¥é”™ â€”â€” æ²¡æœ‰ç»“æŸæ ‡ç­¾  } else if (char &#x3D;&#x3D;&#x3D; EOF) { &#x2F;&#x2F; æŠ¥é”™ â€”â€” ç»“æŸæ ‡ç­¾ä¸åˆæ³•  }}\n\n&#x2F;**\n\næ ‡ç­¾åçŠ¶æ€\n\n\n\nå¦‚æœ \\t(Tabç¬¦)ã€\\n(ç©ºæ ¼ç¬¦)ã€\\f(ç¦æ­¢ç¬¦)æˆ–è€…æ˜¯ç©ºæ ¼ï¼Œè¿™é‡Œå°±æ˜¯å±æ€§çš„å¼€å§‹\n\n\n\nå¦‚æœæ‰¾åˆ° / å°±æ˜¯è‡ªå…³é—­æ ‡ç­¾\n\n\n\nå¦‚æœæ˜¯å­—æ¯å­—ç¬¦é‚£è¿˜æ˜¯æ ‡ç­¾å\n\n\n\nå¦‚æœæ˜¯ &amp;gt; å°±æ˜¯å¼€å§‹æ ‡ç­¾ç»“æŸ\n\n\n\nå…¶ä»–å°±æ˜¯ç»§ç»­å¯»æ‰¾æ ‡ç­¾å\n\n\n@param {*} char *&#x2F;function tagName(char) {  if (char.match(&#x2F;^[\\t\\n\\f ]$&#x2F;)) { return beforeAttributeName  } else if (char &#x3D;&#x3D;&#x3D; â€˜&#x2F;â€˜) { return selfClosingStartTag  } else if (char.match(&#x2F;^[a-zA-Z]$&#x2F;)) { currentToken.tagName +&#x3D; char return tagName  } else if (char &#x3D;&#x3D;&#x3D; â€˜&gt;â€™) { emit(currentToken) return data  } else { return tagName  }}\n\n&#x2F;**\n\næ ‡ç­¾å±æ€§çŠ¶æ€\n\n\n\nå¦‚æœé‡åˆ° / å°±æ˜¯è‡ªå°é—­æ ‡ç­¾çŠ¶æ€\n\n\n\nå¦‚æœé‡åˆ°å­—æ¯å°±æ˜¯å±æ€§å\n\n\n\nå¦‚æœé‡åˆ° &amp;gt; å°±æ˜¯æ ‡ç­¾ç»“æŸ\n\n\n\nå¦‚æœé‡åˆ° = ä¸‹æ¥å°±æ˜¯å±æ€§å€¼\n\n\n\nå…¶ä»–æƒ…å†µç»§ç»­è¿›å…¥å±æ€§æŠ“å–\n\n\n@param {*} char *&#x2F;function beforeAttributeName(char) {  if (char &#x3D;&#x3D;&#x3D; â€˜&#x2F;â€˜) { return selfClosingStartTag  } else if (char.match(&#x2F;^[\\t\\n\\f ]$&#x2F;)) { return beforeAttributeName  } else if (char &#x3D;&#x3D;&#x3D; â€˜&gt;â€™) { emit(currentToken) return data  } else if (char &#x3D;&#x3D;&#x3D; â€˜&#x3D;â€™) { return beforeAttributeName  } else { return beforeAttributeName  }}\n\n&#x2F;**\n\nè‡ªå°é—­æ ‡ç­¾çŠ¶æ€\n\n\n\nå¦‚æœé‡åˆ° &amp;gt; å°±æ˜¯è‡ªå°é—­æ ‡ç­¾ç»“æŸ\n\n\n\nå¦‚æœé‡åˆ° EOF å³ä½¿æŠ¥é”™\n\n\n\nå…¶ä»–å­—ç¬¦ä¹Ÿæ˜¯æŠ¥é”™\n\n\n@param {*} char *&#x2F;function selfClosingStartTag(char) {  if (char &#x3D;&#x3D;&#x3D; â€˜&gt;â€™) { currentToken.isSelfClosing &#x3D; true emit(currentToken) return data  } else if (char &#x3D;&#x3D;&#x3D; â€˜EOFâ€™) {  } else {  }}\n\n&#x2F;**\n\nHTTP è§£æ\n@param {string} html æ–‡æœ¬ *&#x2F;module.exports.parseHTML &#x3D; function (html) {  let state &#x3D; data  for (let char of html) { state &#x3D; state(char)  }  state &#x3D; state(EOF)}Copy\n\nå¤„ç†å±æ€§\nå±æ€§å€¼åˆ†ä¸ºå•å¼•å·ã€åŒå¼•å·ã€æ— å¼•å·ä¸‰ç§å†™æ³•ï¼Œå› æ­¤éœ€è¦è¾ƒå¤šçŠ¶æ€å¤„ç†\nå¤„ç†å±æ€§çš„æ–¹å¼è·Ÿæ ‡ç­¾ç±»ä¼¼\nå±æ€§ç»“æŸæ—¶ï¼Œæˆ‘ä»¬æŠŠå±æ€§åŠ åˆ°æ ‡ç­¾ Token ä¸Š\n\nä¸šåŠ¡é€»è¾‘ï¼š\n\né¦–å…ˆæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ª currentAttribute æ¥å­˜æ”¾å½“å‰æ‰¾åˆ°çš„å±æ€§\nç„¶ååœ¨é‡Œé¢å åŠ å±æ€§çš„åå­—å’Œå±æ€§å€¼ï¼Œéƒ½å®Œæˆåå†æ”¾å…¥ currrentToken ä¹‹ä¸­\næ ‡ç­¾å±æ€§åå¼€å§‹çŠ¶æ€ â€”â€” beforeAttributeName\nè¿™é‡Œå¦‚æœé‡åˆ° ç©ºæ ¼ï¼Œæ¢è¡Œï¼Œå›è½¦ç­‰å­—ç¬¦å°±å¯ä»¥å†æ¬¡è¿›å…¥æ ‡ç­¾å±æ€§åå¼€å§‹çŠ¶æ€ï¼Œç»§ç»­ç­‰å¾…å±æ€§çš„å­—ç¬¦\nå¦‚æœæˆ‘ä»¬é‡åˆ° /æˆ–è€…&gt;å°±æ˜¯æ ‡ç­¾ç›´æ¥ç»“æŸäº†ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›å…¥å±æ€§ç»“æŸçŠ¶æ€\nå¦‚æœé‡åˆ° = æˆ–è€… EOF è¿™é‡Œå°±æœ‰ HTML è¯­æ³•é”™è¯¯ï¼Œæ­£å¸¸æ¥è¯´å°±ä¼šè¿”å› parse error\nå…¶ä»–æƒ…å†µçš„è¯ï¼Œå°±æ˜¯åˆšåˆšå¼€å§‹å±æ€§åï¼Œè¿™é‡Œå°±å¯ä»¥åˆ›å»ºæ–°çš„ currentAttribute å¯¹è±¡ &#123;name: '', value: ''&#125;ï¼Œç„¶åè¿”å›å±æ€§åçŠ¶æ€\n\n\nå±æ€§åçŠ¶æ€ â€”â€” attributeName\nå¦‚æœæˆ‘ä»¬é‡åˆ°ç©ºæ ¼ã€æ¢è¡Œã€å›è½¦ã€/ã€&gt; æˆ–è€…æ˜¯ EOFç­‰å­—ç¬¦æ—¶ï¼Œå°±å¯ä»¥åˆ¤å®šè¿™ä¸ªå±æ€§å·²ç»ç»“æŸäº†ï¼Œå¯ä»¥ç›´æ¥è¿ç§»åˆ° afterAttributeName çŠ¶æ€\nå¦‚æœæˆ‘ä»¬é‡åˆ°ä¸€ä¸ª = å­—ç¬¦ï¼Œè¯æ˜æˆ‘ä»¬çš„å±æ€§åè¯»å–å®Œæ¯•ï¼Œä¸‹æ¥å°±æ˜¯å±æ€§å€¼äº†\nå¦‚æœæˆ‘ä»¬é‡åˆ° \\u0000 é‚£å°±æ˜¯è§£æé”™è¯¯ï¼Œç›´æ¥æŠ›å‡º Parse error\næœ€åæ‰€æœ‰å…¶ä»–çš„éƒ½æ˜¯å½“å‰å±æ€§åçš„å­—ç¬¦ï¼Œç›´æ¥å åŠ åˆ° currentAttribute çš„ name å€¼ä¸­ï¼Œç„¶åç»§ç»­è¿›å…¥å±æ€§åçŠ¶æ€ç»§ç»­è¯»å–å±æ€§åå­—ç¬¦\n\n\nå±æ€§å€¼å¼€å§‹çŠ¶æ€ â€”â€” beforeAttributeValue\nå¦‚æœæˆ‘ä»¬é‡åˆ°ç©ºæ ¼ã€æ¢è¡Œã€å›è½¦ã€/ã€&gt; æˆ–è€…æ˜¯ EOFç­‰å­—ç¬¦æ—¶ï¼Œæˆ‘ä»¬ç»§ç»­å¾€åå¯»æ‰¾å±æ€§å€¼ï¼Œæ‰€ä»¥ç»§ç»­è¿”å› beforeAttributeValue çŠ¶æ€\nå¦‚æœé‡åˆ° \" å°±æ˜¯åŒå¼•å·å±æ€§å€¼ï¼Œè¿›å…¥ doubleQuotedAttributeValue\nå¦‚æœé‡åˆ° ' å°±æ˜¯å•å¼•å·å±æ€§å€¼ï¼Œè¿›å…¥ singleQuotedAttributeValue\nå…¶ä»–æƒ…å†µå°±æ˜¯é‡åˆ°æ²¡æœ‰å¼•å·çš„å±æ€§å€¼ï¼Œä½¿ç”¨ reconsume çš„æŠ€å·§è¿›å…¥ unquotedAttributeValue(char)\n\n\nåŒå¼•å·å±æ€§å€¼çŠ¶æ€ â€“ doubleQuotedAttributeValue\nè¿™é‡Œæˆ‘ä»¬æ­»ç­‰ \" å­—ç¬¦ï¼Œåˆ°è¾¾è¿™ä¸ªå­—ç¬¦è¯æ˜è¿™ä¸ªå±æ€§çš„åå’Œå€¼éƒ½è¯»å–å®Œæ¯•ï¼Œå¯ä»¥ç›´æ¥æŠŠè¿™ä¸¤ä¸ªå€¼æ”¾å…¥å½“å‰ Token äº†\nå¦‚æœé‡åˆ° \\u0000 æˆ–è€… EOF å°±æ˜¯ HTML è¯­æ³•é”™è¯¯ï¼Œç›´æ¥æŠ›å‡º Parse error\nå…¶ä»–æƒ…å†µå°±æ˜¯ç»§ç»­è¯»å–å±æ€§å€¼ï¼Œå¹¶ä¸”å åŠ åˆ° currentAttribute çš„ value ä¸­ï¼Œç„¶åç»§ç»­è¿›å…¥ doubleQuotedAttributeValue\n\n\nå•å¼•å·å±æ€§å€¼çŠ¶æ€ â€”â€” singleQuotedAttributeValue\nä¸åŒå¼•å·é›·åŒï¼Œè¿™é‡Œæˆ‘ä»¬æ­»ç­‰ ' å­—ç¬¦ï¼Œåˆ°è¾¾è¿™ä¸ªå­—ç¬¦è¯æ˜è¿™ä¸ªå±æ€§çš„åå’Œå€¼éƒ½è¯»å–å®Œæ¯•ï¼Œå¯ä»¥ç›´æ¥æŠŠè¿™ä¸¤ä¸ªå€¼æ”¾å…¥å½“å‰ Token äº†\nå¦‚æœé‡åˆ° \\u0000 æˆ–è€… EOF å°±æ˜¯ HTML è¯­æ³•é”™è¯¯ï¼Œç›´æ¥æŠ›å‡º Parse error\nå…¶ä»–æƒ…å†µå°±æ˜¯ç»§ç»­è¯»å–å±æ€§å€¼ï¼Œå¹¶ä¸”å åŠ åˆ° currentAttribute çš„ value ä¸­ï¼Œç„¶åç»§ç»­è¿›å…¥ singleQuotedAttributeValue\n\n\nå¼•å·ç»“æŸçŠ¶æ€ â€”â€” afterQuotedAttributeValue\nå¦‚æœæˆ‘ä»¬é‡åˆ°ç©ºæ ¼ã€æ¢è¡Œã€å›è½¦ç­‰å­—ç¬¦æ—¶ï¼Œè¯æ˜è¿˜æœ‰å¯èƒ½æœ‰å±æ€§å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿ç§»åˆ° beforeAttributeName çŠ¶æ€\nè¿™ä¸ªæ—¶å€™é‡åˆ°ä¸€ä¸ª / å­—ç¬¦ï¼Œå› ä¸ºä¹‹å‰æˆ‘ä»¬è¯»çš„æ˜¯å±æ€§ï¼Œå±æ€§éƒ½æ˜¯åœ¨å¼€å§‹æ ‡ç­¾ä¸­çš„ï¼Œåœ¨å¼€å§‹æ ‡ç­¾é‡åˆ° / ï¼Œé‚£è‚¯å®šæ˜¯è‡ªå°é—­æ ‡ç­¾äº†ã€‚æ‰€ä»¥è¿™é‡Œç›´æ¥è¿ç§»åˆ° selfClosingStartTag çŠ¶æ€\nå¦‚æœé‡åˆ° &gt; å­—ç¬¦ï¼Œè¯æ˜æ ‡ç­¾è¦ç»“æŸäº†ï¼Œç›´æ¥æŠŠå½“å‰ç»„è£…å¥½çš„å±æ€§åå’Œå€¼åŠ å…¥ currentTokenï¼Œ ç„¶åç›´æ¥ emit å‡ºå»\nå¦‚æœé‡åˆ° EOF é‚£å°±æ˜¯ HTML è¯­æ³•é”™è¯¯ï¼ŒæŠ›å‡º Parse error\nå…¶ä»–æƒ…å†µæŒ‰ç…§æµè§ˆå™¨è§„èŒƒï¼Œè¿™é‡Œå±äºå±æ€§ä¹‹é—´ç¼ºå°‘ç©ºæ ¼çš„è§£æé”™è¯¯ (Parse error: missing-whitespace-between-attributes)\n\n\næ— å¼•å·å±æ€§å€¼çŠ¶æ€ â€”â€” unquotedAttributeValue\nå¦‚æœæˆ‘ä»¬é‡åˆ°ç©ºæ ¼ã€æ¢è¡Œã€å›è½¦ç­‰å­—ç¬¦æ—¶ï¼Œè¯æ˜å±æ€§å€¼ç»“æŸï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥æŠŠå½“å‰å±æ€§åŠ å…¥ currentTokenï¼Œç„¶åè¿˜æœ‰å¯èƒ½æœ‰å…¶ä»–å±æ€§ï¼Œæ‰€ä»¥è¿›å…¥ beforeAttributeName çŠ¶æ€\nå¦‚æœé‡åˆ° / è¯æ˜æ ‡ç­¾æ˜¯ä¸€ä¸ªè‡ªå°é—­æ ‡ç­¾ï¼Œå…ˆæŠŠå½“å‰å±æ€§åŠ å…¥ currentToken ç„¶åè¿›å…¥ selfClosingStartTag çŠ¶æ€\nå¦‚æœé‡åˆ° &gt; è¯æ˜æ ‡ç­¾æ­£å¸¸ç»“æŸäº†ï¼Œå…ˆæŠŠå½“å‰å±æ€§åŠ å…¥ currentToken ç„¶åç›´æ¥ emit token\né‡åˆ°å…¶ä»–ä¸åˆæ³•å­—ç¬¦éƒ½ç›´æ¥æŠ›å‡º Parse error\nå…¶ä»–æƒ…å†µå°±æ˜¯è¿˜åœ¨è¯»å–å±æ€§å€¼çš„å­—ç¬¦ï¼Œæ‰€ä»¥å åŠ å½“å‰å­—ç¬¦åˆ°å±æ€§å€¼ä¸­ï¼Œç„¶åç»§ç»­å›åˆ° unquotedAttributeValue\n\n\nå±æ€§åç»“æŸçŠ¶æ€ â€”â€” afterAttributeName\nå¦‚æœæˆ‘ä»¬é‡åˆ°ç©ºæ ¼ã€æ¢è¡Œã€å›è½¦ç­‰å­—ç¬¦æ—¶ï¼Œè¯æ˜è¿˜æ²¡æœ‰æ‰¾åˆ°ç»“æŸå­—ç¬¦ï¼Œç»§ç»­å¯»æ‰¾ï¼Œæ‰€ä»¥é‡æ–°è¿›å…¥ afterAttributeName\nå¦‚æœé‡åˆ° / è¯æ˜è¿™ä¸ªæ ‡ç­¾æ˜¯è‡ªå°é—­æ ‡ç­¾ï¼Œç›´æ¥è¿ç§»åˆ° selfClosingStartTag çŠ¶æ€\nå¦‚æœé‡åˆ° = å­—ç¬¦è¯æ˜ä¸‹ä¸€ä¸ªå­—ç¬¦å¼€å§‹å°±æ˜¯å±æ€§å€¼äº†ï¼Œè¿ç§»åˆ° beforeAttributeValue çŠ¶æ€\nå¦‚æœé‡åˆ° &gt; å­—ç¬¦ï¼Œè¯æ˜æ ‡ç­¾æ­£å¸¸ç»“æŸäº†ï¼Œå…ˆæŠŠå½“å‰å±æ€§åŠ å…¥ currentToken ç„¶åç›´æ¥ emit token\nå¦‚æœé‡åˆ° EOF è¯æ˜ HTML æ–‡æœ¬å¼‚å¸¸ç»“æŸäº†ï¼Œç›´æ¥æŠ›å‡º Parse error\nå…¶ä»–æƒ…å†µä¸‹ï¼Œå±äºå±æ€§ååˆå¼€å§‹äº†ï¼Œæ‰€ä»¥æŠŠä¸Šä¸€ä¸ªå±æ€§åŠ å…¥ currentToken ç„¶åç»§ç»­è®°å½•ä¸‹ä¸€ä¸ªå±æ€§\n\n\n\n\n\n\n\n\n\n\n\n\næ–‡ä»¶åï¼šparser.js\n/**\n * è§£æå™¨\n * @filename parser.js\n * @author ä¸‰é’»\n * @version v1.0.0\n */\n\nlet currentToken &#x3D; nulllet currentAttribute &#x3D; null\n&#x2F;**\n\nè¾“å‡º HTML token\n@param &#123;*&#125; token *&#x2F;function emit(token) &#123;  console.log(token)&#125;\n\nconst EOF &#x3D; Symbol(â€˜EOFâ€™) &#x2F;&#x2F; EOF: end of file\n&#x2F;**\n\nHTML æ•°æ®å¼€å§‹é˜…è¯»çŠ¶æ€\n\n\n\nå¦‚æœæ‰¾åˆ° &amp;lt; å°±æ˜¯æ ‡ç­¾å¼€å§‹çŠ¶æ€\n\n\n\nå¦‚æœæ‰¾åˆ° EOF å°±æ˜¯HTMLæ–‡æœ¬ç»“æŸ\n\n\n\nå…¶ä»–å­—ç¬¦å°±ç»§ç»­å¯»æ‰¾\n\n\n@param {*} char\n\n@return {function} *&#x2F;function data(char) {  if (char &#x3D;&#x3D;&#x3D; â€˜&lt;â€™) { &#x2F;&#x2F; æ ‡ç­¾å¼€å§‹ return tagOpen  } else if (char &#x3D;&#x3D;&#x3D; EOF) { &#x2F;&#x2F; æ–‡æœ¬ç»“æŸ emit({   type: â€˜EOFâ€™, }) return  } else { &#x2F;&#x2F; æ–‡æœ¬ emit({   type: â€˜textâ€™,   content: char, }) return data  }}\n\n&#x2F;**\n\næ ‡ç­¾å¼€å§‹çŠ¶æ€\n\n\n\nå¦‚æœæ‰¾åˆ° / è¯æ˜æ˜¯è‡ªå…³é—­æ ‡ç­¾\n\n\n\nå¦‚æœæ˜¯å­—æ¯å°±æ˜¯æ ‡ç­¾å\n\n\n\nå…¶ä»–å­—ç¬¦å°±ç›´æ¥ç»§ç»­å¯»æ‰¾\n\n\n@param {*} char *&#x2F;function tagOpen(char) {  if (char &#x3D;&#x3D;&#x3D; â€˜&#x2F;â€˜) { &#x2F;&#x2F; è‡ªå…³é—­æ ‡ç­¾ return endTagOpen  } else if (char.match(&#x2F;^[a-zA-Z]$&#x2F;)) { &#x2F;&#x2F; æ ‡ç­¾å currentToken &#x3D; {   type: â€˜startTagâ€™,   tagName: â€˜â€™, } return tagName(char)  } else { return  }}\n\n&#x2F;**\n\næ ‡ç­¾ç»“æŸçŠ¶æ€\n\n\n\nå¦‚æœæ˜¯å­—æ¯å°±æ˜¯æ ‡ç­¾å\n\n\n\nå¦‚æœç›´æ¥æ˜¯ &amp;gt; å°±æŠ¥é”™\n\n\n\nå¦‚æœæ˜¯ç»“æŸç¬¦åˆï¼Œä¹Ÿæ˜¯æŠ¥é”™\n\n\n@param {*} char *&#x2F;function endTagOpen(char) {  if (char.match(&#x2F;^[a-zA-Z]$&#x2F;)) { currentToken &#x3D; {   type: â€˜endTagâ€™,   tagName: â€˜â€™, } return tagName(char)  } else if (char &#x3D;&#x3D;&#x3D; â€˜&gt;â€™) { &#x2F;&#x2F; æŠ¥é”™ â€”â€” æ²¡æœ‰ç»“æŸæ ‡ç­¾  } else if (char &#x3D;&#x3D;&#x3D; EOF) { &#x2F;&#x2F; æŠ¥é”™ â€”â€” ç»“æŸæ ‡ç­¾ä¸åˆæ³•  }}\n\n&#x2F;**\n\næ ‡ç­¾åçŠ¶æ€\n\n\n\nå¦‚æœ \\t(Tabç¬¦)ã€\\n(ç©ºæ ¼ç¬¦)ã€\\f(ç¦æ­¢ç¬¦)æˆ–è€…æ˜¯ç©ºæ ¼ï¼Œè¿™é‡Œå°±æ˜¯å±æ€§çš„å¼€å§‹\n\n\n\nå¦‚æœæ‰¾åˆ° / å°±æ˜¯è‡ªå…³é—­æ ‡ç­¾\n\n\n\nå¦‚æœæ˜¯å­—æ¯å­—ç¬¦é‚£è¿˜æ˜¯æ ‡ç­¾å\n\n\n\nå¦‚æœæ˜¯ &amp;gt; å°±æ˜¯å¼€å§‹æ ‡ç­¾ç»“æŸ\n\n\n\nå…¶ä»–å°±æ˜¯ç»§ç»­å¯»æ‰¾æ ‡ç­¾å\n\n\n@param {*} char *&#x2F;function tagName(char) {  if (char.match(&#x2F;^[\\t\\n\\f ]$&#x2F;)) { return beforeAttributeName  } else if (char &#x3D;&#x3D;&#x3D; â€˜&#x2F;â€˜) { return selfClosingStartTag  } else if (char.match(&#x2F;^[a-zA-Z]$&#x2F;)) { currentToken.tagName +&#x3D; char return tagName  } else if (char &#x3D;&#x3D;&#x3D; â€˜&gt;â€™) { emit(currentToken) return data  } else { return tagName  }}\n\n&#x2F;**\n\næ ‡ç­¾å±æ€§åå¼€å§‹çŠ¶æ€\n\n\n\nå¦‚æœé‡åˆ° / å°±æ˜¯è‡ªå°é—­æ ‡ç­¾çŠ¶æ€\n\n\n\nå¦‚æœé‡åˆ°å­—æ¯å°±æ˜¯å±æ€§å\n\n\n\nå¦‚æœé‡åˆ° &amp;gt; å°±æ˜¯æ ‡ç­¾ç»“æŸ\n\n\n\nå¦‚æœé‡åˆ° = ä¸‹æ¥å°±æ˜¯å±æ€§å€¼\n\n\n\nå…¶ä»–æƒ…å†µç»§ç»­è¿›å…¥å±æ€§æŠ“å–\n\n\n@param {*} char *&#x2F;function beforeAttributeName(char) {  if (char.match(&#x2F;^[\\t\\n\\f ]$&#x2F;)) { return beforeAttributeName  } else if (char &#x3D;&#x3D;&#x3D; â€˜&#x2F;â€˜ || char &#x3D;&#x3D;&#x3D; â€˜&gt;â€™) { return afterAttributeName(char)  } else if (char &#x3D;&#x3D;&#x3D; â€˜&#x3D;â€™ || char &#x3D;&#x3D;&#x3D; EOF) { throw new Error(â€˜Parse errorâ€™)  } else { currentAttribute &#x3D; {   name: â€˜â€™,   value: â€˜â€™, } return attributeName(char)  }}\n\n&#x2F;**\n\nå±æ€§åçŠ¶æ€\n@param {*} char *&#x2F;function attributeName(char) {  if ( char.match(&#x2F;^[\\t\\n\\f ]$&#x2F;) || char &#x3D;&#x3D;&#x3D; â€˜&#x2F;â€˜ || char &#x3D;&#x3D;&#x3D; â€˜&gt;â€™ || char &#x3D;&#x3D;&#x3D; EOF  ) { return afterAttributeName(char)  } else if (char &#x3D;&#x3D;&#x3D; â€˜&#x3D;â€™) { return beforeAttributeValue  } else if (char &#x3D;&#x3D;&#x3D; â€˜\\u0000â€™) { throw new Error(â€˜Parse errorâ€™)  } else { currentAttribute.name +&#x3D; char return attributeName  }}\n\n&#x2F;**\n\nå±æ€§å€¼å¼€å§‹çŠ¶æ€\n@param {*} char *&#x2F;function beforeAttributeValue(char) {  if ( char.match(&#x2F;^[\\t\\n\\f ]$&#x2F;) || char &#x3D;&#x3D;&#x3D; â€˜&#x2F;â€˜ || char &#x3D;&#x3D;&#x3D; â€˜&gt;â€™ || char &#x3D;&#x3D;&#x3D; EOF  ) { return beforeAttributeValue  } else if (char &#x3D;&#x3D;&#x3D; â€˜â€œâ€˜) { return doubleQuotedAttributeValue  } else if (char &#x3D;&#x3D;&#x3D; â€œâ€˜â€œ) { return singleQuotedAttributeValue  } else if (char &#x3D;&#x3D;&#x3D; â€˜&gt;â€™) { &#x2F;&#x2F; return data;  } else { return unquotedAttributeValue(char)  }}\n\n&#x2F;**\n\nåŒå¼•å·å±æ€§å€¼çŠ¶æ€\n@param {*} char *&#x2F;function doubleQuotedAttributeValue(char) {  if (char &#x3D;&#x3D;&#x3D; â€˜â€œâ€˜) { currentToken[currentAttribute.name] &#x3D; currentAttribute.value return afterQuotedAttributeValue  } else if (char &#x3D;&#x3D;&#x3D; â€˜\\u0000â€™) { throw new Error(â€˜Parse errorâ€™)  } else if (char &#x3D;&#x3D;&#x3D; EOF) { throw new Error(â€˜Parse errorâ€™)  } else { currentAttribute.value +&#x3D; char return doubleQuotedAttributeValue  }}\n\n&#x2F;**\n\nå•å¼•å·å±æ€§å€¼çŠ¶æ€\n@param {*} char *&#x2F;function singleQuotedAttributeValue(char) {  if (char &#x3D;&#x3D;&#x3D; â€œâ€˜â€œ) { currentToken[currentAttribute.name] &#x3D; currentAttribute.value return afterQuotedAttributeValue  } else if (char &#x3D;&#x3D;&#x3D; â€˜\\u0000â€™) { throw new Error(â€˜Parse errorâ€™)  } else if (char &#x3D;&#x3D;&#x3D; EOF) { throw new Error(â€˜Parse errorâ€™)  } else { currentAttribute.value +&#x3D; char return singleQuotedAttributeValue  }}\n\n&#x2F;**\n\nå¼•å·ç»“æŸçŠ¶æ€\n@param {*} char *&#x2F;function afterQuotedAttributeValue(char) {  if (char.match(&#x2F;^[\\t\\n\\f ]$&#x2F;)) { return beforeAttributeName  } else if (char &#x3D;&#x3D;&#x3D; â€˜&#x2F;â€˜) { return selfClosingStartTag  } else if (char &#x3D;&#x3D;&#x3D; â€˜&gt;â€™) { currentToken[currentAttribute.name] &#x3D; currentAttribute.value emit(currentToken) return data  } else if (char &#x3D;&#x3D;&#x3D; EOF) { throw new Error(â€˜Parse error: eof-in-tagâ€™)  } else { throw new Error(â€˜Parse error: missing-whitespace-between-attributesâ€™)  }}\n\n&#x2F;**\n\næ— å¼•å·å±æ€§å€¼çŠ¶æ€\n@param {*} char *&#x2F;function unquotedAttributeValue(char) {  if (char.match(&#x2F;^[\\t\\n\\f ]$&#x2F;)) { currentToken[currentAttribute.name] &#x3D; currentAttribute.value return beforeAttributeName  } else if (char &#x3D;&#x3D;&#x3D; â€˜&#x2F;â€˜) { currentToken[currentAttribute.name] &#x3D; currentAttribute.value return selfClosingStartTag  } else if (char &#x3D;&#x3D;&#x3D; â€˜&gt;â€™) { currentToken[currentAttribute.name] &#x3D; currentAttribute.value emit(currentToken) return data  } else if (char &#x3D;&#x3D;&#x3D; â€˜\\u0000â€™) { throw new Error(â€˜Parse errorâ€™)  } else if ( char &#x3D;&#x3D;&#x3D; â€˜â€œâ€˜ || char &#x3D;&#x3D;&#x3D; â€œâ€˜â€œ || char &#x3D;&#x3D;&#x3D; â€˜&lt;â€™ || char &#x3D;&#x3D;&#x3D; â€˜&#x3D;â€™ || char &#x3D;&#x3D;&#x3D; â€˜&#96;â€™  ) { throw new Error(â€˜Parse errorâ€™)  } else if (char &#x3D;&#x3D;&#x3D; EOF) { throw new Error(â€˜Parse errorâ€™)  } else { currentAttribute.value +&#x3D; char return unquotedAttributeValue  }}\n\n&#x2F;**\n\nå±æ€§åç»“æŸçŠ¶æ€\n@param {*} char *&#x2F;function afterAttributeName(char) {  if (char.match(&#x2F;^[\\t\\n\\f ]$&#x2F;)) { return afterAttributeName  } else if (char &#x3D;&#x3D;&#x3D; â€˜&#x2F;â€˜) { return selfClosingStartTag  } else if (char &#x3D;&#x3D;&#x3D; â€˜&#x3D;â€™) { return beforeAttributeValue  } else if (char &#x3D;&#x3D;&#x3D; â€˜&gt;â€™) { currentToken[currentAttribute.name] &#x3D; currentAttribute.value emit(currentToken) return data  } else if (char &#x3D;&#x3D;&#x3D; EOF) { throw new Error(â€˜Parse errorâ€™)  } else { currentToken[currentAttribute.name] &#x3D; currentAttribute.value currentAttribute &#x3D; {   name: â€˜â€™,   value: â€˜â€™, } return attributeName(char)  }}\n\n&#x2F;**\n\nè‡ªå°é—­æ ‡ç­¾çŠ¶æ€\n\n\n\nå¦‚æœé‡åˆ° &amp;gt; å°±æ˜¯è‡ªå°é—­æ ‡ç­¾ç»“æŸ\n\n\n\nå¦‚æœé‡åˆ° EOF å³ä½¿æŠ¥é”™\n\n\n\nå…¶ä»–å­—ç¬¦ä¹Ÿæ˜¯æŠ¥é”™\n\n\n@param {*} char *&#x2F;function selfClosingStartTag(char) {  if (char &#x3D;&#x3D;&#x3D; â€˜&gt;â€™) { currentToken.isSelfClosing &#x3D; true emit(currentToken) return data  } else if (char &#x3D;&#x3D;&#x3D; â€˜EOFâ€™) {  } else {  }}\n\n&#x2F;**\n\nHTTP è§£æ\n@param {string} html æ–‡æœ¬ *&#x2F;module.exports.parseHTML &#x3D; function (html) {  let state &#x3D; data  for (let char of html) { state &#x3D; state(char)  }  state &#x3D; state(EOF)}Copy\n\nç”¨ token æ„å»º DOM æ ‘è¿™é‡Œæˆ‘ä»¬å¼€å§‹è¯­æ³•åˆ†æï¼Œè¿™ä¸ªä¸å¤æ‚çš„ JavaScript çš„è¯­æ³•ç›¸æ¯”å°±éå¸¸ç®€å•ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦ç”¨æ ˆåŸºäºå¯ä»¥å®Œæˆåˆ†æã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬è¦åšä¸€ä¸ªå®Œæ•´çš„æµè§ˆå™¨ï¼Œåªç”¨æ ˆè‚¯å®šæ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºæµè§ˆå™¨æ˜¯æœ‰å®¹é”™æ€§çš„ï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰ç¼–å†™ç»“æŸæ ‡ç­¾çš„è¯ï¼Œæµè§ˆå™¨æ˜¯ä¼šå»ä¸ºæˆ‘ä»¬è¡¥é”™æœºåˆ¶çš„ã€‚\né‚£ä¹ˆæˆ‘åšçš„è¿™ä¸ªç®€å•çš„æµè§ˆå™¨å°±ä¸éœ€è¦å¯¹ä½¿ç”¨è€…åšçš„é‚£ä¹ˆå‹å¥½ï¼Œè€Œåªå¯¹å®ç°è€…åšçš„æ›´å‹å¥½å³å¯ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨å®ç°çš„è¿‡ç¨‹ä¸­å°±ä¸åšé‚£ä¹ˆå¤šç‰¹æ®Šæƒ…å†µçš„å¤„ç†äº†ã€‚ç®€å•ç”¨ä¸€ä¸ªæ ˆå®ç°æµè§ˆå™¨çš„ HTML è¯­æ³•è§£æï¼Œå¹¶ä¸”æ„å»º ä¸€ä¸ª DOM æ ‘ã€‚\n\nä»æ ‡ç­¾æ„å»º DOM æ ‘çš„åŸºæœ¬æŠ€å·§æ˜¯ä½¿ç”¨æ ˆ\né‡åˆ°å¼€å§‹æ ‡ç­¾æ—¶åˆ›å»ºå…ƒç´ å¹¶å…¥æ ˆï¼Œé‡åˆ°ç»“æŸæ ‡ç­¾æ—¶å‡ºæ ˆ\nè‡ªå°é—­èŠ‚ç‚¹å¯è§†ä¸ºå…¥æ ˆåç«‹åˆ»å‡ºæ ˆ\nä»»ä½•å…ƒç´ çš„çˆ¶å…ƒç´ æ˜¯å®ƒå…¥æ ˆå‰çš„æ ˆé¡¶\n\n\n\n\n\n\n\n\n\n\næ–‡ä»¶ï¼šparser.js ä¸­çš„ emit() å‡½æ•°éƒ¨åˆ†\n// é»˜è®¤ç»™äºˆæ ¹èŠ‚ç‚¹ document\nlet stack = [&#123; type: 'document', children: [] &#125;]\n\n&#x2F;**\n\nè¾“å‡º HTML token\n@param &#123;*&#125; token *&#x2F;function emit(token) &#123;  if (token.type &#x3D;&#x3D;&#x3D; â€˜textâ€™) return\n\n  &#x2F;&#x2F; è®°å½•ä¸Šä¸€ä¸ªå…ƒç´  - æ ˆé¡¶  let top &#x3D; stack[stack.length - 1]\n  &#x2F;&#x2F; å¦‚æœæ˜¯å¼€å§‹æ ‡ç­¾  if (token.type &#x3D;&#x3D; â€˜startTagâ€™) &#123;    let element &#x3D; &#123;      type: â€˜elementâ€™,      children: [],      attributes: [],    &#125;\nelement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;tagName &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; token&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;tagName\n\n&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; prop &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; token&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#123;&lt;/span&gt;\n  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;prop &lt;span class=&quot;token operator&quot;&gt;!==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;type&#39;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; prop &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;tagName&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#123;&lt;/span&gt;\n    element&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;attributes&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&#123;&lt;/span&gt;\n      name&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; prop&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;\n      value&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; token&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;prop&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;\n    &lt;span class=&quot;token punctuation&quot;&gt;&#125;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;\n  &lt;span class=&quot;token punctuation&quot;&gt;&#125;&lt;/span&gt;\n&lt;span class=&quot;token punctuation&quot;&gt;&#125;&lt;/span&gt;\n\n&lt;span class=&quot;token comment&quot;&gt;// å¯¹å¶æ“ä½œ&lt;/span&gt;\ntop&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;children&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;element&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;\nelement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;parent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; top\n\n&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;token&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;isSelfClosing&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; stack&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;element&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;\n\ncurrentTextNode &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;\n\n  } else if (token.type &#x3D;&#x3D; â€˜endTagâ€™) {    if (top.tagName !&#x3D;&#x3D; token.tagName) {      throw new Error(â€˜Parse error: Tag start end not matchedâ€™)    } else {      stack.pop()    }\ncurrentTextNode &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;\n\n  }}Copy\nå°†æ–‡æœ¬èŠ‚ç‚¹åŠ åˆ° DOM æ ‘è¿™é‡Œæ˜¯ HTML è§£æçš„æœ€åä¸€æ­¥ï¼ŒæŠŠæ–‡æœ¬èŠ‚ç‚¹åˆå¹¶ååŠ å…¥ DOM æ ‘é‡Œé¢ã€‚\n\næ–‡æœ¬èŠ‚ç‚¹ä¸è‡ªå°é—­æ ‡ç­¾å¤„ç†ç±»ä¼¼\nå¤šä¸ªæ–‡æœ¬èŠ‚ç‚¹éœ€è¦åˆå¹¶\n\n\n\n\n\n\n\n\n\n\næ–‡ä»¶ï¼šparser.js ä¸­çš„ emit() å‡½æ•°éƒ¨åˆ†\nlet currentToken = null\nlet currentAttribute = null\nlet currentTextNode = null\n\n&#x2F;&#x2F; é»˜è®¤ç»™äºˆæ ¹èŠ‚ç‚¹ documentlet stack &#x3D; [&#123; type: â€˜documentâ€™, children: [] &#125;]\n&#x2F;**\n\nè¾“å‡º HTML token\n@param &#123;*&#125; token *&#x2F;function emit(token) &#123;  &#x2F;&#x2F; è®°å½•ä¸Šä¸€ä¸ªå…ƒç´  - æ ˆé¡¶  let top &#x3D; stack[stack.length - 1]\n\n  &#x2F;&#x2F; å¦‚æœæ˜¯å¼€å§‹æ ‡ç­¾  if (token.type &#x3D;&#x3D; â€˜startTagâ€™) &#123;    let element &#x3D; &#123;      type: â€˜elementâ€™,      children: [],      attributes: [],    &#125;\nelement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;tagName &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; token&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;tagName\n\n&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; prop &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; token&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#123;&lt;/span&gt;\n  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;prop &lt;span class=&quot;token operator&quot;&gt;!==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;type&#39;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; prop &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;tagName&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#123;&lt;/span&gt;\n    element&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;attributes&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&#123;&lt;/span&gt;\n      name&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; prop&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;\n      value&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; token&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;prop&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;\n    &lt;span class=&quot;token punctuation&quot;&gt;&#125;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;\n  &lt;span class=&quot;token punctuation&quot;&gt;&#125;&lt;/span&gt;\n&lt;span class=&quot;token punctuation&quot;&gt;&#125;&lt;/span&gt;\n\n&lt;span class=&quot;token comment&quot;&gt;// å¯¹å¶æ“ä½œ&lt;/span&gt;\ntop&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;children&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;element&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;\nelement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;parent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; top\n\n&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;token&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;isSelfClosing&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; stack&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;element&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;\n\ncurrentTextNode &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;\n\n  } else if (token.type &#x3D;&#x3D; â€˜endTagâ€™) {    if (top.tagName !&#x3D;&#x3D; token.tagName) {      throw new Error(â€˜Parse error: Tag start end not matchedâ€™)    } else {      stack.pop()    }\ncurrentTextNode &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;\n\n  } else if (token.type &#x3D;&#x3D;&#x3D; â€˜textâ€™) {    if (currentTextNode &#x3D;&#x3D;&#x3D; null) {      currentTextNode &#x3D; {        type: â€˜textâ€™,        content: â€˜â€™,      }      top.children.push(currentTextNode)    }\ncurrentTextNode&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;content &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; token&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;content\n\n  }}Copy\n\nCSS è®¡ç®—å®Œæˆ HTML è§£æå¹¶ä¸”è·å¾—äº†æˆ‘ä»¬çš„ DOM æ ‘ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ CSS è®¡ç®—æ¥ç”Ÿæˆå¸¦ CSS çš„ DOM æ ‘ã€‚CSS Computing è¡¨ç¤ºçš„å°±æ˜¯æˆ‘ä»¬ CSS è§„åˆ™é‡Œé¢æ‰€åŒ…å«çš„é‚£äº› CSS å±æ€§ï¼Œåº”ç”¨åˆ°åŒ¹é…è¿™äº›é€‰æ‹©å™¨çš„å…ƒç´ ä¸Šã€‚\nå¼€å§‹è¿™ä¸ªä»£ç ç¼–å†™ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ z åœ¨æ•´ä¸ªæµè§ˆå™¨å·¥ä½œæµç¨‹ä¸­ï¼Œæˆ‘ä»¬å®Œæˆäº†å“ªäº›æµç¨‹ï¼Œåˆ°è¾¾äº†å“ªé‡Œã€‚\n\nä¸Šé¢çš„å›¾ï¼Œæˆ‘ä»¬çœ‹åˆ° è“è‰² éƒ¨åˆ†å°±æ˜¯å·²ç»å®Œæˆçš„ï¼š\n\nä¸Šä¸€ç¯‡æ–‡ç« æˆ‘ä»¬å®Œæˆäº† HTTP è¯·æ±‚\nç„¶åé€šè¿‡è·å¾—çš„æŠ¥æ–‡ï¼Œè§£æå‡ºæ‰€æœ‰ HTTP ä¿¡æ¯ï¼Œé‡Œé¢å°±åŒ…æ‹¬äº† HTML å†…å®¹\nç„¶åé€šè¿‡ HTTP å†…å®¹è§£æï¼Œæˆ‘ä»¬æ„å»ºäº†æˆ‘ä»¬çš„ DOM æ ‘\næ¥ä¸‹æ¥å°±æ˜¯ CSS è®¡ç®— (CSS Computing)\n\nç›®å‰çš„ DOM æ ‘åªæœ‰æˆ‘ä»¬çš„ HTML è¯­è¨€é‡Œé¢æè¿°çš„é‚£äº›è¯­ä¹‰ä¿¡æ¯ï¼Œæˆ‘ä»¬åƒå®Œæˆæ¸²æŸ“ï¼Œæˆ‘ä»¬éœ€è¦ CSS ä¿¡æ¯ã€‚ é‚£æœ‰çš„åŒå­¦å°±ä¼šè¯´æˆ‘ä»¬æŠŠæ‰€æœ‰çš„æ ·å¼å†™åˆ° style é‡Œé¢å¯ä¸å¯ä»¥å‘¢ï¼Ÿå¦‚æœæˆ‘ä»¬è¿™æ ·å†™å‘¢ï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦ç»å†è¿™ä¸ª CSS è®¡ç®—çš„è¿‡ç¨‹äº†ã€‚ä½†æ˜¯è™½ç„¶æˆ‘ä»¬åªæ˜¯åšä¸€ä¸ªè™šæ‹Ÿçš„æµè§ˆå™¨ï¼Œä½†æ˜¯è¿˜æ˜¯å¸Œæœ›å‘ˆç°ä¸€ä¸ªæ¯”è¾ƒå®Œæˆçš„æµè§ˆå™¨æµç¨‹ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜æ˜¯ä¼šè®© DOM æ ‘å‚ä¸ CSS è®¡ç®—çš„è¿‡ç¨‹ã€‚\næ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å°±è®© DOM æ ‘æŒ‚ä¸Š CSS ä¿¡æ¯ï¼Œç„¶ååœ¨æ¸²æŸ“çš„è¿‡ç¨‹ä¸­èƒ½ä½¿ç”¨ã€‚\nåœ¨ç¼–å†™è¿™ä¸ªä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å‡†å¤‡ä¸€ä¸ªç¯å¢ƒã€‚å¦‚æœæˆ‘ä»¬éœ€è¦åš CSS è®¡ç®—ï¼Œæˆ‘ä»¬å°±éœ€è¦å¯¹ CSS çš„è¯­æ³•ä¸è¯æ³•è¿›è¡Œåˆ†æã€‚ç„¶åè¿™ä¸ªè¿‡ç¨‹å¦‚æœæ˜¯æ‰‹åŠ¨æ¥å®ç°çš„è¯ï¼Œæ˜¯éœ€è¦è¾ƒå¤šçš„ç¼–è¯‘åŸç†åŸºç¡€çŸ¥è¯†çš„ï¼Œä½†æ˜¯è¿™äº›ç¼–è¯‘åŸºç¡€çŸ¥è¯†çš„æ·±åº¦å¯¹æˆ‘ä»¬çŸ¥è¯†æƒ³äº†è§£æµè§ˆå™¨å·¥ä½œåŸç†å¹¶ä¸æ˜¯é‡ç‚¹ã€‚æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å°±å·ä¸ªæ‡’ï¼Œç›´æ¥ç”¨ npm ä¸Šçš„ä¸€ä¸ªcssç°æˆåŒ…å³å¯ã€‚\nå…¶å®è¿™ä¸ª css åŒ…ï¼Œå°±æ˜¯ä¸€ä¸ª CSS parserï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬å®Œæˆ CSS ä»£ç è½¬è¯‘æˆ AST æŠ½è±¡è¯­æ³•æ ‘ã€‚ æˆ‘ä»¬æ‰€è¦åšçš„å°±æ˜¯æ ¹æ®è¿™æ£µæŠ½è±¡è¯­æ³•æ ‘æŠ½å‡ºå„ç§ CSS è§„åˆ™ï¼Œå¹¶ä¸”æŠŠä»–ä»¬è¿ç”¨åˆ°æˆ‘ä»¬çš„ HTML å…ƒç´ ä¸Šã€‚\né‚£ä¹ˆæˆ‘ä»¬ç¬¬ä¸€æ­¥å°±æ˜¯å…ˆæ‹¿åˆ° CSS çš„è§„åˆ™ï¼Œæ‰€ä»¥å«åš â€œæ”¶é›† CSS è§„åˆ™â€\næ”¶é›† CSS è§„åˆ™\né‡åˆ° style æ ‡ç­¾æ—¶ï¼Œæˆ‘ä»¬æŠŠ CSS è§„åˆ™ä¿å­˜èµ·æ¥\n\n\n\n\n\n\n\n\n\n\næ–‡ä»¶ï¼šparser.js ä¸­çš„ emit() å‡½æ•°\n\næˆ‘ä»¬åœ¨ tagName === â€˜endTagâ€™ çš„åˆ¤æ–­ä¸­åŠ å…¥äº†åˆ¤æ–­å½“å‰æ ‡ç­¾æ˜¯å¦ style æ ‡ç­¾\nå¦‚æœæ˜¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥è·å– style æ ‡ç­¾é‡Œé¢æ‰€æœ‰çš„å†…å®¹è¿›è¡Œ CSS åˆ†æ\nè¿™é‡Œéå¸¸ç®€å•æˆ‘ä»¬åŠ å…¥ä¸€ä¸ª addCSSRule(top.children[0].content)çš„å‡½æ•°å³å¯\nè€Œï¼Œtop å°±æ˜¯å½“å‰å…ƒç´ ï¼Œchildren[0] å°±æ˜¯ text å…ƒç´ ï¼Œè€Œ .content å°±æ˜¯æ‰€æœ‰çš„ CSS è§„åˆ™æ–‡æœ¬\nè¿™é‡Œæˆ‘ä»¬éœ€è¦æ³¨æ„ä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬å¿½ç•¥äº†åœ¨å®é™…æƒ…å†µä¸­è¿˜æœ‰ link æ ‡ç­¾å¼•å…¥ CSS æ–‡ä»¶çš„æƒ…å†µã€‚ä½†æ˜¯è¿™ä¸ªè¿‡ç¨‹æ¶‰åŠåˆ°å¤šå±‚å¼‚æ­¥è¯·æ±‚å’Œ HTML è§£æçš„è¿‡ç¨‹ï¼Œä¸ºäº†ç®€åŒ–æˆ‘ä»¬çš„ä»£ç çš„å¤æ‚åº¦ï¼Œè¿™é‡Œå°±ä¸åšè¿™ä¸ªå®ç°äº†ã€‚å½“ç„¶å®é™…çš„æµè§ˆå™¨æ˜¯ä¼šæ¯”æˆ‘ä»¬åšçš„è™šæ‹Ÿæµè§ˆå™¨å¤æ‚çš„å¤šã€‚\n\n/**\n * è¾“å‡º HTML token\n * @param &#123;*&#125; token\n */\nfunction emit(token) &#123;\n  // è®°å½•ä¸Šä¸€ä¸ªå…ƒç´  - æ ˆé¡¶\n  let top = stack[stack.length - 1]\n\n  &#x2F;&#x2F; å¦‚æœæ˜¯å¼€å§‹æ ‡ç­¾  if (token.type &#x3D;&#x3D; â€˜startTagâ€™) &#123;    &#x2F;&#x2F; â€¦â€¦â€¦â€¦. çœç•¥äº†è¿™éƒ¨åˆ†ä»£ç  â€¦â€¦â€¦â€¦â€¦â€¦â€¦  &#125; else if (token.type &#x3D;&#x3D; â€˜endTagâ€™) &#123;    &#x2F;&#x2F; æ ¡éªŒå¼€å§‹æ ‡ç­¾æ˜¯å¦è¢«ç»“æŸ    &#x2F;&#x2F; ä¸æ˜¯ï¼šç›´æ¥æŠ›å‡ºé”™è¯¯ï¼Œæ˜¯ï¼šç›´æ¥å‡ºæ ˆ    if (top.tagName !&#x3D;&#x3D; token.tagName) &#123;      throw new Error(â€˜Parse error: Tag start end not matchedâ€™)    &#125; else &#123;      &#x2F;&#x2F; é‡åˆ° style æ ‡ç­¾æ—¶ï¼Œæ‰§è¡Œæ·»åŠ  CSS è§„åˆ™çš„æ“ä½œ      if (top.tagName &#x3D;&#x3D;&#x3D; â€˜styleâ€™) &#123;        addCSSRule(top.children[0].content)      &#125;      stack.pop()    &#125;\ncurrentTextNode &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;\n\n  } else if (token.type &#x3D;&#x3D;&#x3D; â€˜textâ€™) {    &#x2F;&#x2F; â€¦â€¦â€¦â€¦. çœç•¥äº†è¿™éƒ¨åˆ†ä»£ç  â€¦â€¦â€¦â€¦â€¦â€¦â€¦  }}Copy\n\nè¿™é‡Œæˆ‘ä»¬è°ƒç”¨ CSS Parser æ¥åˆ†æ CSS è§„åˆ™\n\n\n\n\n\n\n\n\n\n\næ–‡ä»¶ï¼šparser.js ä¸­åŠ å…¥ addCSSRule() å‡½æ•°\n\né¦–å…ˆæˆ‘ä»¬éœ€è¦é€šè¿‡ node å¼•å…¥ css åŒ…\nç„¶åè°ƒç”¨ css.parse(text) è·å¾— AST æŠ½è±¡è¯­æ³•æ ‘\næœ€åé€šè¿‡ä½¿ç”¨ ... çš„ç‰¹æ€§å±•å¼€äº† ast.stylesheet.rules ä¸­çš„æ‰€æœ‰å¯¹è±¡ï¼Œå¹¶ä¸”åŠ å…¥åˆ° rules é‡Œé¢\n\nconst css = require('css')\n\nlet rules &#x3D; []&#x2F;**\n\næŠŠ CSS è§„åˆ™æš‚å­˜åˆ°ä¸€ä¸ªæ•°å­—é‡Œ\n@param &#123;*&#125; text *&#x2F;function addCSSRule(text) &#123;  var ast &#x3D; css.parse(text)  console.log(JSON.stringify(ast, null, â€˜    â€˜))  rules.push(â€¦ast.stylesheet.rules)&#125;Copy\n\n\nè¿™é‡Œæˆ‘ä»¬å¿…é¡»è¦ä»”ç»†ç ”ç©¶æ­¤åº“åˆ†æ CSS è§„åˆ™çš„æ ¼å¼\n\næœ€ç»ˆ AST è¾“å‡ºçš„ç»“æœï¼š\n\ntype ç±»å‹æ˜¯ stylesheet æ ·å¼è¡¨\nç„¶ååœ¨ stylesheet ä¸­æœ‰ rules çš„ CSS è§„åˆ™æ•°ç»„\nrules æ•°ç»„ä¸­å°±æœ‰ä¸€ä¸ª declarations æ•°ç»„ï¼Œè¿™é‡Œé¢å°±æ˜¯æˆ‘ä»¬ CSS æ ·å¼çš„ä¿¡æ¯äº†\næ‹¿ç¬¬ä¸€ä¸ª delarations æ¥è¯´æ˜ï¼Œä»–çš„å±æ€§ä¸º widthï¼Œ å±æ€§å€¼ä¸º 100pxï¼Œè¿™äº›å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„ CSS è§„åˆ™äº†\n\n&#123;\n  \"type\": \"stylesheet\",\n  \"stylesheet\": &#123;\n    \"source\": undefined,\n    \"rules\": [\n      &#123;\n        \"type\": \"rule\",\n        \"selectors\": [\"body div #myId\"],\n        \"declarations\": [\n          &#123;\n            \"type\": \"declaration\",\n            \"property\": \"width\",\n            \"value\": \"100px\",\n            \"position\": &#123;\n              \"start\": &#123;\n                \"line\": 3,\n                \"column\": 9\n              &#125;,\n              \"end\": &#123;\n                \"line\": 3,\n                \"column\": 21\n              &#125;,\n              \"source\": undefined\n            &#125;\n          &#125;,\n          &#123;\n            \"type\": \"declaration\",\n            \"property\": \"background-color\",\n            \"value\": \"#ff5000\",\n            \"position\": &#123;\n              \"start\": &#123;\n                \"line\": 4,\n                \"column\": 9\n              &#125;,\n              \"end\": &#123;\n                \"line\": 4,\n                \"column\": 34\n              &#125;,\n              \"source\": undefined\n            &#125;\n          &#125;\n        ],\n        \"position\": &#123;\n          \"start\": &#123;\n            \"line\": 2,\n            \"column\": 7\n          &#125;,\n          \"end\": &#123;\n            \"line\": 5,\n            \"column\": 8\n          &#125;,\n          \"source\": undefined\n        &#125;\n      &#125;\n    ],\n    \"parsingErrors\": []\n  &#125;\n&#125;Copy\n\n\n\n\n\n\n\n\n\n\nè¿™é‡Œè¿˜æœ‰ä¸€ä¸ªé—®é¢˜éœ€è¦æˆ‘ä»¬æ³¨æ„çš„ï¼Œåƒ body div #myId è¿™ç§å¸¦æœ‰ç©ºæ ¼çš„æ ‡ç­¾é€‰æ‹©å™¨ï¼Œæ˜¯ä¸ä¼šé€ä¸ªç»™æˆ‘ä»¬å•ç‹¬åˆ†æå‡ºæ¥çš„ï¼Œæ‰€ä»¥è¿™ç§æˆ‘ä»¬æ˜¯éœ€è¦åœ¨åé¢è‡ªå·±é€ä¸ªåˆ†è§£åˆ†æã€‚é™¤éæ˜¯ , é€—å·åˆ†éš”çš„é€‰æ‹©å™¨æ‰ä¼šè¢«æ‹†è§£æˆå¤šä¸ª delarationsã€‚\næ·»åŠ è°ƒç”¨ä¸Šä¸€æ­¥æˆ‘ä»¬æ”¶é›†å¥½äº† CSS è§„åˆ™ï¼Œè¿™ä¸€æ­¥æˆ‘ä»¬å°±æ˜¯è¦æ‰¾ä¸€ä¸ªåˆé€‚çš„æ—¶æœºæŠŠè¿™äº›è§„åˆ™åº”ç”¨ä¸Šã€‚åº”ç”¨çš„æ—¶æœºè‚¯å®šæ˜¯è¶Šæ—©è¶Šå¥½ï¼ŒCSS è®¾è®¡é‡Œé¢æœ‰ä¸€ä¸ªæ½œè§„åˆ™ï¼Œå°±æ˜¯ CSS è®¾è®¡ä¼šå°½é‡ä¿è¯æ‰€æœ‰çš„é€‰æ‹©å™¨éƒ½èƒ½å¤Ÿåœ¨ startTag è¿›å…¥çš„æ—¶å€™å°±èƒ½è¢«åˆ¤æ–­ã€‚\nå½“ç„¶ï¼Œæˆ‘ä»¬åé¢åˆåŠ äº†ä¸€äº›é«˜çº§çš„é€‰æ‹©å™¨ä¹‹åï¼Œè¿™ä¸ªè§„åˆ™æœ‰äº†ä¸€å®šçš„æ¾åŠ¨ï¼Œä½†æ˜¯å¤§éƒ¨åˆ†çš„è§„åˆ™ä»ç„¶æ˜¯å»éµå¾ªè¿™ä¸ªè§„åˆ™çš„ï¼Œå½“æˆ‘ä»¬ DOM æ ‘æ„å»ºåˆ°å…ƒç´ çš„ startTag çš„æ­¥éª¤ï¼Œå°±å·²ç»å¯ä»¥åˆ¤æ–­å‡ºæ¥å®ƒèƒ½åŒ¹é…é‚£äº› CSS è§„åˆ™äº†\n\nå½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå…ƒç´ åï¼Œç«‹å³è®¡ç®— CSS\næˆ‘ä»¬å‡è®¾ï¼šç†è®ºä¸Šï¼Œå½“æˆ‘ä»¬åˆ†æä¸€ä¸ªå…ƒç´ æ—¶ï¼Œæ‰€æœ‰çš„ CSS è§„åˆ™å·²ç»è¢«æ”¶é›†å®Œæ¯•\nåœ¨çœŸå®æµè§ˆå™¨ä¸­ï¼Œå¯èƒ½é‡åˆ°å†™åœ¨ body çš„ style æ ‡ç­¾ï¼Œéœ€è¦é‡æ–° CSS è®¡ç®—çš„æƒ…å†µï¼Œè¿™é‡Œæˆ‘ä»¬å¿½ç•¥\n\n\n\n\n\n\n\n\n\n\næ–‡ä»¶ï¼šparser.js çš„ emit() å‡½æ•°åŠ å…¥ computeCSS() å‡½æ•°è°ƒç”¨\n/**\n * è¾“å‡º HTML token\n * @param &#123;*&#125; token\n */\nfunction emit(token) &#123;\n  // è®°å½•ä¸Šä¸€ä¸ªå…ƒç´  - æ ˆé¡¶\n  let top = stack[stack.length - 1]\n\n  &#x2F;&#x2F; å¦‚æœæ˜¯å¼€å§‹æ ‡ç­¾  if (token.type &#x3D;&#x3D; â€˜startTagâ€™) &#123;    let element &#x3D; &#123;      type: â€˜elementâ€™,      children: [],      attributes: [],    &#125;\nelement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;tagName &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; token&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;tagName\n\n&lt;span class=&quot;token comment&quot;&gt;// å åŠ æ ‡ç­¾å±æ€§&lt;/span&gt;\n&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; prop &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; token&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#123;&lt;/span&gt;\n  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;prop &lt;span class=&quot;token operator&quot;&gt;!==&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;type&#39;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; prop &lt;span class=&quot;token operator&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;tagName&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#123;&lt;/span&gt;\n    element&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;attributes&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&#123;&lt;/span&gt;\n      name&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; prop&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;\n      value&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; token&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;prop&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;\n    &lt;span class=&quot;token punctuation&quot;&gt;&#125;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;\n  &lt;span class=&quot;token punctuation&quot;&gt;&#125;&lt;/span&gt;\n&lt;span class=&quot;token punctuation&quot;&gt;&#125;&lt;/span&gt;\n\n&lt;span class=&quot;token comment&quot;&gt;// å…ƒç´ æ„å»ºå¥½ä¹‹åç›´æ¥å¼€å§‹ CSS è®¡ç®—&lt;/span&gt;\n&lt;span class=&quot;token function&quot;&gt;computeCSS&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;element&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;\n\n&lt;span class=&quot;token comment&quot;&gt;// å¯¹å¶æ“ä½œ&lt;/span&gt;\ntop&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;children&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;element&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;\nelement&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;parent &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; top\n&lt;span class=&quot;token comment&quot;&gt;// è‡ªå°é—­æ ‡ç­¾ä¹‹å¤–ï¼Œå…¶ä»–éƒ½å…¥æ ˆ&lt;/span&gt;\n&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;token&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;isSelfClosing&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; stack&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;element&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;\n\ncurrentTextNode &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;\n\n  } else if (token.type &#x3D;&#x3D; â€˜endTagâ€™) {    &#x2F;&#x2F; â€¦â€¦â€¦â€¦. çœç•¥äº†è¿™éƒ¨åˆ†ä»£ç  â€¦â€¦â€¦â€¦â€¦â€¦â€¦  } else if (token.type &#x3D;&#x3D;&#x3D; â€˜textâ€™) {    &#x2F;&#x2F; â€¦â€¦â€¦â€¦. çœç•¥äº†è¿™éƒ¨åˆ†ä»£ç  â€¦â€¦â€¦â€¦â€¦â€¦â€¦  }}Copy\n\n\n\n\n\n\n\n\n\næ–‡ä»¶ï¼šparser.js ä¸­åŠ å…¥ computeCSS() å‡½æ•°\n/**\n * å¯¹å…ƒç´ è¿›è¡Œ CSS è®¡ç®—\n * @param &#123;*&#125; element\n */\nfunction computeCSS(element) &#123;\n  console.log(rules)\n  console.log('compute CSS for Element', element)\n&#125;Copy\n\nè·å–çˆ¶å…ƒç´ åºåˆ—ä¸ºä»€ä¹ˆéœ€è¦è·å–çˆ¶å…ƒç´ åºåˆ—å‘¢ï¼Ÿå› ä¸ºæˆ‘ä»¬ä»Šå¤©çš„é€‰æ‹©å™¨å¤§å¤šæ•°éƒ½æ˜¯è·Ÿå…ƒç´ çš„çˆ¶å…ƒç´ ç›¸å…³çš„ã€‚\n\nåœ¨ computeCSS å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¿…é¡»çŸ¥é“å…ƒç´ çš„æ‰€æœ‰çˆ¶çº§å…ƒç´ æ‰èƒ½åˆ¤æ–­å…ƒç´ ä¸è§„åˆ™æ˜¯å¦åŒ¹é…\næˆ‘ä»¬ä»ä¸Šä¸€æ­¥éª¤çš„ stackï¼Œå¯ä»¥è·å–æœ¬å…ƒç´ çš„çˆ¶å…ƒç´ \nå› ä¸ºæˆ‘ä»¬é¦–å…ˆè·å–çš„æ˜¯ â€œå½“å‰å…ƒç´ â€ï¼Œæ‰€ä»¥æˆ‘ä»¬è·å¾—å’Œè®¡ç®—çˆ¶å…ƒç´ åŒ¹é…çš„é¡ºåºæ˜¯ä»å†…å‘å¤–\n\n\n\n\n\n\n\n\n\n\næ–‡ä»¶ï¼šparser.js ä¸­çš„ computeCSS() å‡½æ•°\n\nå› ä¸ºæ ˆé‡Œé¢çš„å…ƒç´ æ˜¯ä¼šä¸æ–­çš„å˜åŒ–çš„ï¼Œæ‰€ä»¥åæœŸå…ƒç´ ä¼šåœ¨æ ˆä¸­å‘ç”Ÿå˜åŒ–ï¼Œå°±ä¼šå¯èƒ½è¢«æ±¡æŸ“ã€‚æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬ç”¨äº†ä¸€ä¸ªsliceæ¥å¤åˆ¶è¿™ä¸ªå…ƒç´ ã€‚\nç„¶åæˆ‘ä»¬ç”¨äº† reverse() æŠŠå…ƒç´ çš„é¡ºåºå€’è¿‡æ¥ï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦é¢ å€’å…ƒç´ çš„é¡ºåºå‘¢ï¼Ÿæ˜¯å› ä¸ºæˆ‘ä»¬çš„æ ‡ç­¾åŒ¹é…æ˜¯ä¼šä»å½“å‰å…ƒç´ å¼€å§‹é€çº§çš„å¾€å¤–åŒ¹é…ï¼ˆä¹Ÿå°±æ˜¯ä¸€çº§ä¸€çº§å¾€çˆ¶çº§å…ƒç´ å»åŒ¹é…çš„ï¼‰\n\n/**\n * å¯¹å…ƒç´ è¿›è¡Œ CSS è®¡ç®—\n * @param &#123;*&#125; element\n */\nfunction computeCSS(element) &#123;\n  var elements = stack.slice().reverse()\n&#125;Copy\n\né€‰æ‹©å™¨ä¸å…ƒç´ çš„åŒ¹é…é¦–å…ˆæˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹é€‰æ‹©å™¨çš„æœºæ„ï¼Œå…¶å®é€‰æ‹©å™¨å…¶å®æ˜¯æœ‰ä¸€ä¸ªå±‚çº§ç»“æ„çš„ï¼š\n\næœ€å¤–å±‚å«é€‰æ‹©å™¨åˆ—è¡¨ï¼Œè¿™ä¸ªæˆ‘ä»¬çš„ CSS parser å·²ç»å¸®æˆ‘ä»¬åšäº†æ‹†åˆ†\né€‰æ‹©å™¨åˆ—è¡¨é‡Œé¢çš„ï¼Œå«åšå¤æ‚é€‰æ‹©å™¨ï¼Œè¿™ä¸ªæ˜¯ç”±ç©ºæ ¼åˆ†éš”äº†æˆ‘ä»¬çš„å¤åˆé€‰æ‹©å™¨\nå¤æ‚é€‰æ‹©å™¨æ˜¯æ ¹æ®äº²ä»£å…³ç³»ï¼Œå»é€‰æ‹©å…ƒç´ çš„\nå¤åˆé€‰æ‹©å™¨ï¼Œæ˜¯é’ˆå¯¹ä¸€ä¸ªå…ƒç´ çš„æœ¬èº«çš„å±æ€§å’Œç‰¹å¾çš„åˆ¤æ–­\nè€Œå¤åˆåŸåˆ™æ€§é€‰æ‹©å™¨ï¼Œå®ƒåˆæ˜¯ç”±ç´§è¿ç€çš„ä¸€å¯¹é€‰æ‹©å™¨è€Œæ„æˆçš„\nåœ¨æˆ‘ä»¬çš„æ¨¡æ‹Ÿæµè§ˆå™¨ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å‡è®¾ä¸€ä¸ªå¤æ‚é€‰æ‹©å™¨ä¸­åªåŒ…å«ç®€å•é€‰æ‹©å™¨\næˆ‘ä»¬å°±æŠŠè¿™ç§æƒ…å†µå½“æˆè€Œå¤–æœ‰ç²¾åŠ›çš„åŒå­¦è‡ªè¡Œå»å®ç°äº†å“ˆ\n\næ€è·¯ï¼š\n\né€‰æ‹©å™¨ä¹Ÿè¦ä»å½“å‰å…ƒç´ å‘å¤–æ’åˆ—\nå¤æ‚é€‰æ‹©å™¨æ‹†æˆå¯¹å•ä¸ªå…ƒç´ çš„é€‰æ‹©å™¨ï¼Œç”¨å¾ªç¯åŒ¹é…çˆ¶çº§å…ƒç´ é˜Ÿåˆ—\n\n/**\n * åŒ¹é…å‡½æ•°ä¸‹ä¸€èŠ‚ä¼šé‡ç‚¹å®ç°\n * @param &#123;*&#125; element\n * @param &#123;*&#125; selector\n */\nfunction match(element, selector) &#123;&#125;\n\n&#x2F;**\n\nå¯¹å…ƒç´ è¿›è¡Œ CSS è®¡ç®—\n@param &#123;*&#125; element *&#x2F;function computeCSS(element) &#123;  var elements &#x3D; stack.slice().reverse()\n\n  if (!elements.computedStyle) element.computedStyle &#x3D; &#123;&#125;  &#x2F;&#x2F; è¿™é‡Œå¾ªç¯ CSS è§„åˆ™ï¼Œè®©è§„åˆ™ä¸å…ƒç´ åŒ¹é…  &#x2F;&#x2F; 1.  å¦‚æœå½“å‰é€‰æ‹©å™¨åŒ¹é…ä¸ä¸­å½“å‰å…ƒç´ ç›´æ¥ continue  &#x2F;&#x2F; 2. å½“å‰å…ƒç´ åŒ¹é…ä¸­äº†ï¼Œå°±ä¸€ç›´å¾€å¤–å¯»æ‰¾çˆ¶çº§å…ƒç´ æ‰¾åˆ°èƒ½åŒ¹é…ä¸Šé€‰æ‹©å™¨çš„å…ƒç´   &#x2F;&#x2F; 3. æœ€åæ£€éªŒåŒ¹é…ä¸­çš„å…ƒç´ æ˜¯å¦ç­‰äºé€‰æ‹©å™¨çš„æ€»æ•°ï¼Œæ˜¯å°±æ˜¯å…¨éƒ¨åŒ¹é…äº†ï¼Œä¸æ˜¯å°±æ˜¯ä¸åŒ¹é…  for (let rule of rules) &#123;    let selectorParts &#x3D; rule.selectors[0].split(â€˜ â€˜).reverse()\n&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;element&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; selectorParts&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;continue&lt;/span&gt;\n\n&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; matched &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;\n\n&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; j &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;\n&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; elements&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#123;&lt;/span&gt;\n  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;elements&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; selectorParts&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;j&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; j&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;\n&lt;span class=&quot;token punctuation&quot;&gt;&#125;&lt;/span&gt;\n\n&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;j &lt;span class=&quot;token operator&quot;&gt;&amp;gt;=&lt;/span&gt; selectorParts&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; matched &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;\n\n&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;matched&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Element&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; element&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;matched rule&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; rule&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;\n\n  }}Copy\nè®¡ç®—é€‰æ‹©å™¨ä¸å…ƒç´ ä¸Šä¸€èŠ‚æˆ‘ä»¬æ²¡æœ‰å®Œæˆ match åŒ¹é…å‡½æ•°çš„å®ç°ï¼Œé‚£è¿™ä¸€éƒ¨åˆ†æˆ‘ä»¬æ¥ä¸€èµ·å®ç°å…ƒç´ ä¸é€‰æ‹©å™¨çš„åŒ¹é…é€»è¾‘ã€‚\n\næ ¹æ®é€‰æ‹©å™¨çš„ç±»å‹å’Œå…ƒç´ å±æ€§ï¼Œè®¡ç®—æ˜¯å¦ä¸å½“å‰å…ƒç´ åŒ¹é…\nè¿™é‡Œä»…ä»…å®ç°äº†ä¸‰ç§åŸºæœ¬é€‰æ‹©å™¨ï¼Œå®é™…çš„æµè§ˆå™¨ä¸­è¦å¤„ç†å¤åˆé€‰æ‹©å™¨\nåŒå­¦ä»¬å¯ä»¥è‡ªå·±å°è¯•ä¸€ä¸‹å®ç°å¤åˆé€‰æ‹©å™¨ï¼Œå®ç°æ”¯æŒç©ºæ ¼çš„ Class é€‰æ‹©å™¨\n\n/**\n * åŒ¹é…å…ƒç´ å’Œé€‰æ‹©å™¨\n * @param &#123;Object&#125; element å½“å‰å…ƒç´ \n * @param &#123;String&#125; selector CSS é€‰æ‹©å™¨\n */\nfunction match(element, selector) &#123;\n  if (!selector || !element.attributes) return false\n\n  if (selector.charAt(0) &#x3D;&#x3D;&#x3D; â€˜#â€™) &#123;    let attr &#x3D; element.attributes.filter((attr) &#x3D;&gt; attr.name &#x3D;&#x3D;&#x3D; â€˜idâ€™)[0]    if (attr &amp;&amp; attr.value &#x3D;&#x3D;&#x3D; selector.replace(â€˜#â€™, â€˜â€™)) return true  &#125; else if (selector.charAt(0) &#x3D;&#x3D;&#x3D; â€˜.â€™) &#123;    let attr &#x3D; element.attributes.filter((attr) &#x3D;&gt; attr.name &#x3D;&#x3D;&#x3D; â€˜classâ€™)[0]    if (attr &amp;&amp; attr.value &#x3D;&#x3D;&#x3D; selector.replace(â€˜.â€™, â€˜â€™)) return true  &#125; else &#123;    if (element.tagName &#x3D;&#x3D;&#x3D; selector) return true  &#125;\n  return false&#125;Copy\nç”Ÿæˆ computed å±æ€§è¿™ä¸€éƒ¨åˆ†æˆ‘ä»¬ç”Ÿæˆ computed å±æ€§ï¼Œè¿™é‡Œæˆ‘ä»¬åªéœ€è¦æŠŠ delarations é‡Œé¢å£°æ˜çš„å±æ€§ç»™ä»–åŠ åˆ°æˆ‘ä»¬çš„å…ƒç´ çš„ computed ä¸Šå°±å¯ä»¥äº†ã€‚\n\nä¸€æ—¦é€‰æ‹©å™¨åŒ¹é…ä¸­äº†ï¼Œå°±æŠŠé€‰æ‹©å™¨ä¸­çš„å±æ€§åº”ç”¨åˆ°å…ƒç´ ä¸Š\nç„¶åå½¢æˆ computedStyle\n\n/**\n * å¯¹å…ƒç´ è¿›è¡Œ CSS è®¡ç®—\n * @param &#123;*&#125; element\n */\nfunction computeCSS(element) &#123;\n  var elements = stack.slice().reverse()\n\n  if (!elements.computedStyle) element.computedStyle &#x3D; &#123;&#125;  &#x2F;&#x2F; è¿™é‡Œå¾ªç¯ CSS è§„åˆ™ï¼Œè®©è§„åˆ™ä¸å…ƒç´ åŒ¹é…  &#x2F;&#x2F; 1. å¦‚æœå½“å‰é€‰æ‹©å™¨åŒ¹é…ä¸ä¸­å½“å‰å…ƒç´ ç›´æ¥ continue  &#x2F;&#x2F; 2. å½“å‰å…ƒç´ åŒ¹é…ä¸­äº†ï¼Œå°±ä¸€ç›´å¾€å¤–å¯»æ‰¾çˆ¶çº§å…ƒç´ æ‰¾åˆ°èƒ½åŒ¹é…ä¸Šé€‰æ‹©å™¨çš„å…ƒç´   &#x2F;&#x2F; 3. æœ€åæ£€éªŒåŒ¹é…ä¸­çš„å…ƒç´ æ˜¯å¦ç­‰äºé€‰æ‹©å™¨çš„æ€»æ•°ï¼Œæ˜¯å°±æ˜¯å…¨éƒ¨åŒ¹é…äº†ï¼Œä¸æ˜¯å°±æ˜¯ä¸åŒ¹é…  for (let rule of rules) &#123;    let selectorParts &#x3D; rule.selectors[0].split(â€˜ â€˜).reverse()\n&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;element&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; selectorParts&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;continue&lt;/span&gt;\n\n&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; matched &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;\n\n&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; j &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;\n&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; elements&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#123;&lt;/span&gt;\n  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;elements&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; selectorParts&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;j&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; j&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;\n&lt;span class=&quot;token punctuation&quot;&gt;&#125;&lt;/span&gt;\n\n&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;j &lt;span class=&quot;token operator&quot;&gt;&amp;gt;=&lt;/span&gt; selectorParts&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; matched &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;\n\n&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;matched&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#123;&lt;/span&gt;\n  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; computedStyle &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; element&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;computedStyle\n  &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; declaration &lt;span class=&quot;token keyword&quot;&gt;of&lt;/span&gt; rule&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;declarations&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#123;&lt;/span&gt;\n    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;computedStyle&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;declaration&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;property&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;\n      computedStyle&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;declaration&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;property&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#123;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&#125;&lt;/span&gt;\n    computedStyle&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;declaration&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;property&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; declaration&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value\n  &lt;span class=&quot;token punctuation&quot;&gt;&#125;&lt;/span&gt;\n  console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;computedStyle&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;\n&lt;span class=&quot;token punctuation&quot;&gt;&#125;&lt;/span&gt;\n\n  }}Copy\n\n\n\n\n\n\n\n\n\nçœ‹å®Œä»£ç çš„åŒå­¦ï¼Œæˆ–è€…è‡ªå·±å»å®ç°è¿™ä¸ªä»£ç æ—¶å€™çš„åŒå­¦ï¼Œåº”è¯¥ä¼šå‘ç°è¿™ä¸ªä»£ç ä¸­æœ‰ä¸€ä¸ªé—®é¢˜ã€‚å¦‚æœæˆ‘ä»¬å›å»çœ‹çœ‹æˆ‘ä»¬çš„ HTML ä»£ç ä¸­çš„ style æ ·å¼è¡¨ï¼Œæˆ‘ä»¬å‘ç° HTML ä¸­çš„ img æ ‡ç­¾ä¼šè¢«ä¸¤ä¸ª CSS é€‰æ‹©å™¨åŒ¹é…ä¸­ï¼Œåˆ†åˆ«æ˜¯ body div #myId å’Œ body div imgã€‚è¿™æ ·å°±ä¼šå¯¼è‡´å‰é¢åŒ¹é…ä¸­ååŠ å…¥ computedStyle çš„å±æ€§å€¼ä¼šè¢«åé¢åŒ¹é…ä¸­çš„å±æ€§å€¼æ‰€è¦†ç›–ã€‚ä½†æ˜¯æ ¹æ® CSS ä¸­çš„æƒé‡è§„åˆ™ï¼ŒID é€‰æ‹©å™¨æ˜¯é«˜äºæ ‡ç­¾é€‰æ‹©å™¨çš„ã€‚è¿™ä¸ªé—®é¢˜æˆ‘ä»¬ä¸‹ä¸€éƒ¨åˆ†ä¼šå’ŒåŒå­¦ä»¬ä¸€èµ·è§£å†³æ‰å“¦ã€‚\nSpecificity çš„è®¡ç®—é€»è¾‘ä¸Šä¸€èŠ‚çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬åªæ˜¯æŠŠåŒ¹é…ä¸­çš„é€‰æ‹©å™¨ä¸­çš„å±æ€§ç›´æ¥è¦†ç›–ä¸Šä¸€ä¸ªï¼Œä½†æ˜¯å…¶å®åœ¨ CSS é‡Œé¢æ˜¯æœ‰ä¸€ä¸ª specification çš„è§„å®šã€‚specification ç¿»è¯‘æˆä¸­æ–‡ï¼Œå¾ˆå¤šæ—¶å€™éƒ½ä¼šè¢«ç¿»è¯‘æˆ ä¼˜å…ˆçº§ï¼Œå½“ç„¶åœ¨ç†è®ºä¸Šæ˜¯å¯¹çš„ï¼Œä½†æ˜¯åœ¨è‹±æ–‡ä¸­å‘¢ï¼Œä¼˜å…ˆçº§æ˜¯ priorityï¼Œæ‰€ä»¥ specificity æ˜¯ ä¸“æŒ‡ç¨‹åº¦ã€‚\næ”¾åœ¨ CSS ä¸­ç†è§£å°±æ˜¯ï¼ŒID é€‰æ‹©å™¨ä¸­çš„ä¸“æŒ‡åº¦æ˜¯ä¼šæ¯” CLASS é€‰æ‹©å™¨çš„é«˜ï¼Œæ‰€ä»¥ CSS ä¸­çš„ ID çš„å±æ€§ä¼šè¦†ç›– CLASS çš„å±æ€§ã€‚\nå¥½æˆ‘ä»¬å…ˆæ¥ç†è§£ä¸€ä¸‹ specification æ˜¯ä»€ä¹ˆï¼Ÿ\n\né¦–å…ˆ specifity ä¼šæœ‰å››ä¸ªå…ƒç´ \næŒ‰ç…§ CSS ä¸­ä¼˜å…ˆçº§çš„é¡ºåºæ¥è¯´å°±æ˜¯ inline style &gt; id &gt; class &gt; tag\næ‰€ä»¥æŠŠè¿™ä¸ªç”Ÿæˆä¸º specificity å°±æ˜¯ [0, 0, 0, 0]\næ•°ç»„é‡Œé¢æ¯ä¸€ä¸ªæ•°å­—éƒ½æ˜¯ä»£è¡¨åœ¨æ ·å¼è¡¨ä¸­å‡ºç°çš„æ¬¡æ•°\n\nä¸‹é¢æˆ‘ä»¬ç”¨ä¸€äº›ä¾‹å­æ¥åˆ†æä¸€ä¸‹ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•ç”¨ specificity æ¥åˆ†è¾¨ä¼˜å…ˆçº§çš„ï¼š\n\n\n\n\n\n\n\n\n\nA ç»„é€‰æ‹©å™¨\nA é€‰æ‹©å™¨ï¼šdiv div #idA çš„ specification ï¼š[0, 1, 0, 2]\n\nid å‡ºç°äº†ä¸€æ¬¡ï¼Œæ‰€ä»¥ç¬¬äºŒä½æ•°å­—æ˜¯ 1\ndiv tag å‡ºç°äº†ä¸¤æ¬¡ï¼Œæ‰€ä»¥ç¬¬å››ä½æ•°æ˜¯ 2\n\nB ç»„é€‰æ‹©å™¨\nB é€‰æ‹©å™¨ï¼šdiv #my #id\nB çš„ specificationï¼š[0, 2, 0, 1]\n\nid å‡ºç°äº†ä¸¤æ¬¡ï¼Œæ‰€ä»¥ç¬¬äºŒä½æ•°å­—æ˜¯ 2\ndiv tag å‡ºç°äº†ä¸€æ¬¡ï¼Œæ‰€ä»¥ç¬¬å››ä½æ•°æ˜¯ 1\n\nå¥½ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ€ä¹ˆå»æ¯”è¾ƒä¸Šé¢çš„ä¸¤ç§é€‰æ‹©å™¨ï¼Œé‚£ä¸ªæ›´å¤§å‘¢ï¼Ÿ\n\næˆ‘ä»¬éœ€è¦ä»å·¦åˆ°å³å¼€å§‹æ¯”å¯¹ï¼›\né‡åˆ°åŒä½ç½®çš„æ•°å€¼ä¸€æ ·çš„ï¼Œå°±å¯ä»¥ç›´æ¥è·³è¿‡ï¼›\nç›´åˆ°æˆ‘ä»¬æ‰¾åˆ°ä¸€å¯¹æ•°å€¼æ˜¯æœ‰ä¸ä¸€æ ·çš„ï¼Œè¿™ä¸ªæ—¶å€™å°±çœ‹æ˜¯å“ªä¸ªé€‰æ‹©å™¨ä¸­çš„æ•°å€¼æ›´å¤§ï¼Œé‚£ä¸ªé€‰æ‹©å™¨çš„ä¼˜å…ˆçº§å°±æ›´é«˜ï¼›\nåªè¦æœ‰ä¸€å¯¹æ¯”å¯¹å‡ºå¤§å°åï¼Œåé¢çš„å°±ä¸éœ€è¦å†æ¯”å¯¹äº†ã€‚\n\nç”¨ä¸Šé¢ A å’Œ B ä¸¤ç§é€‰æ‹©å™¨æ¥åšå¯¹æ¯”çš„è¯ï¼Œç¬¬ä¸€å¯¹ä¸¤ä¸ªéƒ½æ˜¯ 0ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è·³è¿‡ã€‚\nç„¶åç¬¬äºŒä½æ•°å€¼å¯¹ï¼ŒA é€‰æ‹©å™¨æ˜¯ 1ï¼ŒB é€‰æ‹©å™¨æ˜¯ 2ï¼Œå¾ˆæ˜æ˜¾ B è¦æ¯” A å¤§ï¼Œæ‰€ä»¥ B é€‰æ‹©å™¨ä¸­çš„å±æ€§å°±è¦è¦†ç›– A çš„ã€‚\nè¯´åˆ°è¿™é‡ŒåŒå­¦ä»¬åº”è¯¥éƒ½æ˜ç™½ CSS ä¸­ specificity çš„è§„åˆ™å’Œå¯¹æ¯”åŸç†äº†ï¼Œä¸‹æ¥æˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹å¦‚ä½•å®ç°è¿™ä¸ªä»£ç é€»è¾‘ã€‚\n\nCSS è§„åˆ™æ ¹æ® specificity å’Œåæ¥ä¼˜å…ˆè§„åˆ™è¦†ç›–\nspecificity æ˜¯ä¸ªå››å…ƒç»„ï¼Œè¶Šå·¦è¾¹æƒé‡è¶Šé«˜\nä¸€ä¸ª CSS è§„åˆ™çš„ specificity æ ¹æ®åŒ…å«çš„ç®€å•é€‰æ‹©å™¨ç›¸åŠ è€Œæˆ\n\n\n\n\n\n\n\n\n\n\næ–‡ä»¶ï¼šparser.js ä¸­æ·»åŠ ä¸€ä¸ª specificity å‡½æ•°ï¼Œæ¥è®¡ç®—ä¸€ä¸ªé€‰æ‹©å™¨çš„ specificity\n/**\n * è®¡ç®—é€‰æ‹©å™¨çš„ specificity\n * @param &#123;*&#125; selector\n */\nfunction specificity(selector) &#123;\n  let p = [0, 0, 0, 0]\n  let selectorParts = selector.split(' ')\n  for (let part of selectorParts) &#123;\n    if (part.charAt(0) === '#') &#123;\n      p[1] += 1\n    &#125; else if (part.charAt(0) === '.') &#123;\n      p[2] += 1\n    &#125; else &#123;\n      p[3] += 1\n    &#125;\n  &#125;\n  return p\n&#125;Copy\n\n\n\n\n\n\n\n\n\n\næ–‡ä»¶ï¼šparser.js æ·»åŠ ä¸€ä¸ª compare å‡½æ•°ï¼Œæ¥å¯¹æ¯”ä¸¤ä¸ªé€‰æ‹©å™¨çš„ specificity\n/**\n * å¯¹æ¯”ä¸¤ä¸ªé€‰æ‹©å™¨çš„ specificity\n * @param &#123;*&#125; sp1\n * @param &#123;*&#125; sp2\n */\nfunction compare(sp1, sp2) &#123;\n  for (let i = 0; i &lt;= 3; i++) &#123;\n    if (i === 3) return sp1[3] - sp2[3]\n    if (sp1[i] - sp2[i]) return sp1[i] - sp2[i]\n  &#125;\n&#125;Copy\n\n\n\n\n\n\n\n\n\n\næ–‡ä»¶ï¼šparser.js çš„ computeCSS ä¸­ä¿®æ”¹åŒ¹é…ä¸­å…ƒç´ åçš„å±æ€§èµ‹å€¼é€»è¾‘\n/**\n * å¯¹å…ƒç´ è¿›è¡Œ CSS è®¡ç®—\n * @param &#123;*&#125; element\n */\nfunction computeCSS(element) &#123;\n  var elements = stack.slice().reverse()\n\n  if (!elements.computedStyle) element.computedStyle &#x3D; &#123;&#125;  &#x2F;&#x2F; è¿™é‡Œå¾ªç¯ CSS è§„åˆ™ï¼Œè®©è§„åˆ™ä¸å…ƒç´ åŒ¹é…  &#x2F;&#x2F; 1. å¦‚æœå½“å‰é€‰æ‹©å™¨åŒ¹é…ä¸ä¸­å½“å‰å…ƒç´ ç›´æ¥ continue  &#x2F;&#x2F; 2. å½“å‰å…ƒç´ åŒ¹é…ä¸­äº†ï¼Œå°±ä¸€ç›´å¾€å¤–å¯»æ‰¾çˆ¶çº§å…ƒç´ æ‰¾åˆ°èƒ½åŒ¹é…ä¸Šé€‰æ‹©å™¨çš„å…ƒç´   &#x2F;&#x2F; 3. æœ€åæ£€éªŒåŒ¹é…ä¸­çš„å…ƒç´ æ˜¯å¦ç­‰äºé€‰æ‹©å™¨çš„æ€»æ•°ï¼Œæ˜¯å°±æ˜¯å…¨éƒ¨åŒ¹é…äº†ï¼Œä¸æ˜¯å°±æ˜¯ä¸åŒ¹é…  for (let rule of rules) &#123;    let selectorParts &#x3D; rule.selectors[0].split(â€˜ â€˜).reverse()\n&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;element&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; selectorParts&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;continue&lt;/span&gt;\n\n&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; matched &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;\n\n&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; j &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;\n&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; elements&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#123;&lt;/span&gt;\n  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;match&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;elements&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;i&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; selectorParts&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;j&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; j&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;\n&lt;span class=&quot;token punctuation&quot;&gt;&#125;&lt;/span&gt;\n\n&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;j &lt;span class=&quot;token operator&quot;&gt;&amp;gt;=&lt;/span&gt; selectorParts&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; matched &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;\n\n&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;matched&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#123;&lt;/span&gt;\n  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; sp &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;specificity&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;rule&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;selectors&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;\n  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; computedStyle &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; element&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;computedStyle\n  &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; declaration &lt;span class=&quot;token keyword&quot;&gt;of&lt;/span&gt; rule&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;declarations&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#123;&lt;/span&gt;\n    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;computedStyle&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;declaration&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;property&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;\n      computedStyle&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;declaration&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;property&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#123;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&#125;&lt;/span&gt;\n\n    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;computedStyle&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;declaration&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;property&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;specificity&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#123;&lt;/span&gt;\n      computedStyle&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;declaration&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;property&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; declaration&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value\n      computedStyle&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;declaration&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;property&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;specificity &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sp\n    &lt;span class=&quot;token punctuation&quot;&gt;&#125;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;\n      &lt;span class=&quot;token function&quot;&gt;compare&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;computedStyle&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;declaration&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;property&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;specificity&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; sp&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;\n    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;&#123;&lt;/span&gt;\n      computedStyle&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;declaration&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;property&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; declaration&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value\n      computedStyle&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;declaration&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;property&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;specificity &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sp\n    &lt;span class=&quot;token punctuation&quot;&gt;&#125;&lt;/span&gt;\n  &lt;span class=&quot;token punctuation&quot;&gt;&#125;&lt;/span&gt;\n&lt;span class=&quot;token punctuation&quot;&gt;&#125;&lt;/span&gt;\n\n  }}Copy\n\næœ€åæˆ‘ä»¬è¿™é‡Œå°±å®Œæˆäº†æµè§ˆå™¨å·¥ä½œåŸç†ä¸­çš„ HTML è§£æå’Œ CSS è®¡ç®—ã€‚\nä¸‹ä¸€ç¯‡æ–‡ç« æˆ‘ä»¬æ¥ä¸€èµ·å®Œæˆæ’ç‰ˆå’Œæ¸²æŸ“ä¸¤ä¸ªæµè§ˆå™¨è¿‡ç¨‹ã€‚æ•¬è¯·æœŸå¾…ï¼\n\næ¨èä¸“æ å°ä¼™ä¼´ä»¬å¯ä»¥æŸ¥çœ‹æˆ–è€…è®¢é˜…ç›¸å…³çš„ä¸“æ ï¼Œä»è€Œé›†ä¸­é˜…è¯»ç›¸å…³çŸ¥è¯†çš„æ–‡ç« å“¦ã€‚\n\nğŸ“– ã€Šæ•°æ®ç»“æ„ä¸ç®—æ³•ã€‹ â€” åˆ°äº†å¦‚ä»Šï¼Œå¦‚æœæƒ³æˆä¸ºä¸€ä¸ªé«˜çº§å¼€å‘å·¥ç¨‹å¸ˆæˆ–è€…è¿›å…¥å¤§å‚ï¼Œä¸è®ºå²—ä½æ˜¯å‰ç«¯ã€åç«¯è¿˜æ˜¯ AIï¼Œç®—æ³•éƒ½æ˜¯é‡ä¸­ä¹‹é‡ã€‚ä¹Ÿæ— è®ºæˆ‘ä»¬éœ€è¦è¿›å…¥çš„å…¬å¸çš„å²—ä½æ˜¯å¦æœ€åæ˜¯åšç®—æ³•å·¥ç¨‹å¸ˆï¼Œå‰æé¢è¯•å°±éœ€è¦è€ƒç®—æ³•ã€‚\n\nğŸ“– ã€ŠFCC å‰ç«¯é›†è®­è¥ã€‹ â€” æ ¹æ® FreeCodeCamp çš„å­¦ä¹ è¯¾ç¨‹ï¼Œä¸€èµ·æ·±å…¥æµ…å‡ºå­¦ä¹ å‰ç«¯ã€‚ç¨³å›ºå‰ç«¯çŸ¥è¯†ï¼Œä¸€èµ·åœ¨ FreeCodeCamp è·å¾—è¯ä¹¦\n\nğŸ“– ã€Šå‰ç«¯æ˜Ÿçƒã€‹ â€” ä»¥å®æˆ˜ä¸ºçº¿ç´¢ï¼Œæ·±å…¥æµ…å‡ºå‰ç«¯å¤šç»´åº¦çš„çŸ¥è¯†ç‚¹ã€‚å†…å«æœ‰å¤šæ–¹é¢çš„å‰ç«¯çŸ¥è¯†æ–‡ç« ï¼Œå¸¦é¢†ä¸æ‡‚å‰ç«¯çš„ç«¥é‹ä¸€èµ·å­¦ä¹ å‰ç«¯ï¼Œåœ¨å‰ç«¯å¼€å‘è·¯ä¸Šç«¥é‹ä¸€èµ·ç‡ƒèµ·å¿ƒä¸­é‚£å›¢ç« ğŸ”¥\n\n\n\n\n\n\n\n","slug":"test","date":"2021-09-26T15:32:04.000Z","categories_index":"è½¯ä»¶å­¦å ‚","tags_index":"æ ‡ç­¾æµ‹è¯•","author_index":"é“¾æ¡¥"}]